<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>dlog – ELK</title>
    <link>/elk/</link>
    <description>Recent content in ELK on dlog</description>
    <generator>Hugo -- gohugo.io</generator>
    
	  <atom:link href="/elk/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
      
    
    
    <item>
      <title>ELK: 2022.01.29</title>
      <link>/elk/20220129-apache_log/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/elk/20220129-apache_log/</guid>
      <description>
        
        
        

&lt;div class=&#34;pageinfo pageinfo-primary&#34;&gt;
&lt;p&gt;apache 로그파일 &amp;gt; filebeat &amp;gt; logstash &amp;gt; elastic 저장 과정에 대한 이해&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;apache 로그에 대한 포맷&lt;/li&gt;
&lt;li&gt;logstash 의 filter&lt;/li&gt;
&lt;li&gt;elastic 에 저장된 내용을 kibana 에서 조회&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;

&lt;h4 id=&#34;apache-로그&#34;&gt;apache 로그&lt;/h4&gt;
&lt;p&gt;apache 로그는 httpd.conf 에 아래와 같이 정의되어 있다.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&amp;lt;IfModule log_config_module&amp;gt;
    LogFormat &amp;#34;%h %l %u %t \&amp;#34;%r\&amp;#34; %&amp;gt;s %b \&amp;#34;%{Referer}i\&amp;#34; \&amp;#34;%{User-Agent}i\&amp;#34;&amp;#34; combined
    LogFormat &amp;#34;%h %l %u %t \&amp;#34;%r\&amp;#34; %&amp;gt;s %b&amp;#34; common
    &amp;lt;IfModule logio_module&amp;gt;
      LogFormat &amp;#34;%h %l %u %t \&amp;#34;%r\&amp;#34; %&amp;gt;s %b \&amp;#34;%{Referer}i\&amp;#34; \&amp;#34;%{User-Agent}i\&amp;#34; %I %O&amp;#34; combinedio
    &amp;lt;/IfModule&amp;gt;
    CustomLog &amp;#34;/outlog/WEB/httpd/access.log&amp;#34; combined
&amp;lt;/IfModule&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;combined&lt;/code&gt; 라는 이름의 &lt;code&gt;&amp;quot;%h %l %u %t \&amp;quot;%r\&amp;quot; %&amp;gt;s %b \&amp;quot;%{Referer}i\&amp;quot; \&amp;quot;%{User-Agent}i\&amp;quot;&amp;quot;&lt;/code&gt; 형식을 풀이하면 이렇다.&lt;/p&gt;
&lt;p&gt;예시 로그&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;172.28.200.30 - - [29/Jan/2022:14:23:44 +0900] &amp;#34;GET /repository/maven-snapshot/mgkim/framework/framework-core/maven-metadata.xml HTTP/1.1&amp;#34; 200 599 &amp;#34;-&amp;#34; &amp;#34;curl/7.61.1&amp;#34;
{
  &amp;#34;request&amp;#34;: &amp;#34;/repository/maven-snapshot/mgkim/framework/framework-core/maven-metadata.xml&amp;#34;,
  &amp;#34;agent&amp;#34;: &amp;#34;\&amp;#34;curl/7.61.1\&amp;#34;&amp;#34;,
  &amp;#34;auth&amp;#34;: &amp;#34;-&amp;#34;,
  &amp;#34;ident&amp;#34;: &amp;#34;-&amp;#34;,
  &amp;#34;verb&amp;#34;: &amp;#34;GET&amp;#34;,
  &amp;#34;referrer&amp;#34;: &amp;#34;\&amp;#34;-\&amp;#34;&amp;#34;,
  &amp;#34;response&amp;#34;: &amp;#34;200&amp;#34;,
  &amp;#34;bytes&amp;#34;: &amp;#34;599&amp;#34;,
  &amp;#34;clientip&amp;#34;: &amp;#34;172.28.200.30&amp;#34;,
  &amp;#34;httpversion&amp;#34;: &amp;#34;1.1&amp;#34;,
  &amp;#34;timestamp&amp;#34;: &amp;#34;29/Jan/2022:14:23:44 +0900&amp;#34;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;포맷&lt;/th&gt;
&lt;th&gt;설명&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;%h&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;원격 호스트 이름&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;%l&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ident 인증으로 알아낸 os 의 사용자명 &lt;a href=&#34;https://www.rfc-editor.org/rfc/rfc1413.txt&#34; target=&#34;_blank&#34;&gt;rfc1413&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;%u&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;HTTP 인증으로 알아낸 사용자ID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;%r&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;요청 uri (&lt;code&gt;%m %U%q %H&lt;/code&gt; 와 같다.)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

      </description>
    </item>
    
  </channel>
</rss>
