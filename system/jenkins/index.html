<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.87.0" /><META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>jenkins | dlog</title>


  
  <meta name="description" content="plugins
Publish Over SSH
mvn 빌드 후 생성된 artifact 파일을 sftp 로 전송하고 ssh 로 command 를 실행하는 기능을 사용할 수 있습니다.

프로젝트 구성에서 빌드 후 조치 &gt; Send build artifacts over …">
<meta property="og:title" content="jenkins" />
<meta property="og:description" content="plugins Publish Over SSH mvn 빌드 후 생성된 artifact 파일을 sftp 로 전송하고 ssh 로 command 를 실행하는 기능을 사용할 수 있습니다.
 프로젝트 구성에서 빌드 후 조치 &gt; Send build artifacts over SSH 선택 Add Server 버튼을 클릭하여 SSH Server 선택  선택되는 서버는 빌드 결과물인 artifact 파일을 전송하고, ssh 로 command 를 실행할 서버를 의미함 아래 Transfer Set 에 설정되는 Exec command의 내용이 빌드 로그에 출력되도록 고급버튼을 눌러 Verbose output in console 을 선택할 것 [INFO] ------------------------------------------------------------------------ SSH: Connecting from host [i9-9900K] SSH: Connecting with configuration [tomcat@develop] ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/system/jenkins/" /><meta property="article:section" content="system" />



<meta itemprop="name" content="jenkins">
<meta itemprop="description" content="plugins Publish Over SSH mvn 빌드 후 생성된 artifact 파일을 sftp 로 전송하고 ssh 로 command 를 실행하는 기능을 사용할 수 있습니다.
 프로젝트 구성에서 빌드 후 조치 &gt; Send build artifacts over SSH 선택 Add Server 버튼을 클릭하여 SSH Server 선택  선택되는 서버는 빌드 결과물인 artifact 파일을 전송하고, ssh 로 command 를 실행할 서버를 의미함 아래 Transfer Set 에 설정되는 Exec command의 내용이 빌드 로그에 출력되도록 고급버튼을 눌러 Verbose output in console 을 선택할 것 [INFO] ------------------------------------------------------------------------ SSH: Connecting from host [i9-9900K] SSH: Connecting with configuration [tomcat@develop] .">

<meta itemprop="wordCount" content="1317">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="jenkins"/>
<meta name="twitter:description" content="plugins Publish Over SSH mvn 빌드 후 생성된 artifact 파일을 sftp 로 전송하고 ssh 로 command 를 실행하는 기능을 사용할 수 있습니다.
 프로젝트 구성에서 빌드 후 조치 &gt; Send build artifacts over SSH 선택 Add Server 버튼을 클릭하여 SSH Server 선택  선택되는 서버는 빌드 결과물인 artifact 파일을 전송하고, ssh 로 command 를 실행할 서버를 의미함 아래 Transfer Set 에 설정되는 Exec command의 내용이 빌드 로그에 출력되도록 고급버튼을 눌러 Verbose output in console 을 선택할 것 [INFO] ------------------------------------------------------------------------ SSH: Connecting from host [i9-9900K] SSH: Connecting with configuration [tomcat@develop] ."/>




<link rel="preload" href="/scss/main.min.49935c5eb3f96e225026ec04fa18256b17f945124066cf7317bb40fab0c32ac4.css" as="style">
<link href="/scss/main.min.49935c5eb3f96e225026ec04fa18256b17f945124066cf7317bb40fab0c32ac4.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script
  src="https://unpkg.com/lunr@2.3.8/lunr.min.js"
  integrity="sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY"
  crossorigin="anonymous"></script>










  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"></span><span class="text-uppercase font-weight-bold">dlog</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link active" href="/system/" ><i class='fas fa-book'></i><span class="active">system</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/framework/" ><i class='fas fa-book'></i><span>framework</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/localenv/" ><i class='fas fa-book'></i><span>localenv</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">



<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="/offline-search-index.e5962fff43344f5d8e292f2d2ec452d1.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="10"
>

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            
<div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    



<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="/offline-search-index.e5962fff43344f5d8e292f2d2ec452d1.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="10"
>


    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    <ul class="td-sidebar-nav__section pr-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-system-li">
  
  <a href="/system/" title="시스템 환경" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-system"><span class="">system</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-systemhttpd-li">
  
  <a href="/system/httpd/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-systemhttpd"><span class="">httpd</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-systemjenkins-li">
  
  <a href="/system/jenkins/" class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id="m-systemjenkins"><span class="td-sidebar-nav-active-item">jenkins</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-systemlinux-li">
  
  <a href="/system/linux/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-systemlinux"><span class="">linux</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-systemopenssh-li">
  
  <a href="/system/openssh/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-systemopenssh"><span class="">openssh</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-systemopenssl-li">
  
  <a href="/system/openssl/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-systemopenssl"><span class="">openssl</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-systemoracle-li">
  
  <a href="/system/oracle/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-systemoracle"><span class="">oracle</span></a>
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            
  
  
  
  
  
  
  <div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
  
  
  </div>


            


<div class="td-toc"><nav id="TableOfContents">
  <ul>
    <li><a href="#plugins">plugins</a>
      <ul>
        <li><a href="#publish-over-ssh">Publish Over SSH</a></li>
        <li><a href="#gitlab-plugin">GitLab Plugin</a></li>
        <li><a href="#github-integration-plugin">GitHub Integration Plugin</a></li>
      </ul>
    </li>
    <li><a href="#build">build</a>
      <ul>
        <li><a href="#분산-빌드-환경">분산 빌드 환경</a></li>
        <li><a href="#github-연결">github 연결</a></li>
      </ul>
    </li>
  </ul>
</nav></div>



            

	
		



  
  

	
		



  
  

	

          </aside>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		







<li class="breadcrumb-item" >
	<a href="/system/">system</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="/system/jenkins/">jenkins</a>
</li>

	</ol>
</nav	>

            
<div class="td-content">
	<h1>jenkins</h1>
	
	<header class="article-meta">
		
		
			
				


			
				


			
		
		
	</header>    
	<h2 id="plugins">plugins</h2>
<h3 id="publish-over-ssh">Publish Over SSH</h3>
<p>mvn 빌드 후 생성된 artifact 파일을 sftp 로 전송하고 ssh 로 command 를 실행하는 기능을 사용할 수 있습니다.</p>
<ol>
<li>프로젝트 구성에서 <code>빌드 후 조치</code> &gt; <code>Send build artifacts over SSH</code> 선택</li>
<li><code>Add Server</code> 버튼을 클릭하여 <code>SSH Server</code> 선택
<ul>
<li>선택되는 서버는 빌드 결과물인 artifact 파일을 전송하고, ssh 로 command 를 실행할 서버를 의미함</li>
<li>아래 <code>Transfer Set</code> 에 설정되는 <code>Exec command</code>의 내용이 빌드 로그에 출력되도록 <code>고급</code>버튼을 눌러 <code>Verbose output in console</code> 을 선택할 것<br/>
<pre><code>[INFO] ------------------------------------------------------------------------
SSH: Connecting from host [i9-9900K]
SSH: Connecting with configuration [tomcat@develop] ...
SSH: Creating session: username [tomcat], hostname [develop], port [22]
SSH: Connecting session ...
SSH: Connected
SSH: Opening SFTP channel ...
SSH: SFTP channel open
SSH: Connecting SFTP channel ...
SSH: Connected
SSH: cd [/app/WAS/prototype]
SSH: OK
SSH: cd [/app/WAS/prototype]
SSH: OK
SSH: cd [boot-www]
SSH: OK
SSH: put [boot-www-0.0.1-SNAPSHOT.war]
SSH: OK
SSH: cd [/app/WAS/prototype]
SSH: OK
SSH: cd [boot-www]
SSH: OK
SSH: put [deploy.sh]
SSH: OK
SSH: Opening exec channel ...
SSH: EXEC: channel open
SSH: EXEC: STDOUT/STDERR from command [chmod u+x /app/WAS/prototype/boot-www/deploy.sh

/app/WAS/prototype/boot-www/deploy.sh restart] ...
SSH: EXEC: connected
Stopping boot-www
stopped boot-www
Starting boot-www
SSH: EXEC: completed after 1,202 ms
SSH: Disconnecting configuration [tomcat@develop] ...
SSH: Transferred 2 ( 1 + 1 ) file(s)
Finished: SUCCESS
</code></pre></li>
</ul>
</li>
<li><code>Add Transfer Set</code> 버튼을 클릭하여 <code>Transfers Set</code> 입력
<ul>
<li><code>Source files</code>: 전송할 파일을 입력 (예: **/target/*.war)</li>
<li><code>Remove prefix</code>: 전송시 source files 의 파일경로를 제거 (예: ./boot-www/target/)</li>
<li><code>Remote directory</code>: &hellip; (예: boot-www 라고 입력하면 /app/WAS/prototype/boot-www 이렇게 base-dir 하위에 디렉토리를 생성하여 source files 가 전송됨)</li>
<li><code>Exec command</code>: 파일 전송 후 실행할 command 를 입력 (배포 후 container 재시작을 하기 위한 command 입력)</li>
<li>참고로 war 파일과 was 재시작을 위한 sh 파일을 같이 전송해야하는 경우에는 <code>Transfers Set</code>을 2개로 나눠서 전송하는 방법도 있음</li>
</ul>
</li>
</ol>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">SSH Server 추가하기</h4>

    <p><code>SSH Server</code> 는 <code>Jenkins 관리</code> &gt; <code>시스템 설정</code> &gt; <code>Publish over SSH</code> 에서 추가를 해야 선택하는 항목이 나옵니다.</p>
<ul>
<li><code>Passphrase</code>: 시스템 계정 jenkins 로 생성한 rsa 키의 비밀번호를 입력합니다.</li>
<li><code>Path to key</code>: rsa 키 쌍 중 개인키의 경로를 입력합니다. (/home/jenkins/.ssh/id_rsa)
jenkins node 구성에서 slave-node 을 추가했다면 jenkins 를 호스팅하고 있는 서버에서 생성한 개인키 파일에 접근할 수 없기에 <code>Key</code> 항목에 개인키를 설정하여 사용해야 함</li>
<li><code>Key</code>: 개인키의 경로를 입력하지 않을 경우 개인키의 내용 추가로 설정할 수 있습니다. (키 경로 입력 시 생략할 것)<br/>
개인키의 형태는 다음과 같으며 참고로 jenkins 에 설정할때에는 BEGIN 부터 END 까지 모두 입력해야 합니다.
<pre><code>-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,BB513C74CDF53133B6B805F08C716E14
<p>lqXA6gIhaf3ztU1SoQVGvUtLWtXqINxbGzNfau3v+DIHRKJjVY1JvBj2mmADIxEq
&hellip;
YqTPbiAOgnHAD9CgWg/v55Zl9zLrPKLakCJPYzGNrLo2BJ4qXR1ZX371JEsXq8tq
&mdash;&ndash;END RSA PRIVATE KEY&mdash;&ndash;
</code></pre></li></p>
<li><code>SSH Servers</code>에 추가 버튼을 클릭하여 hostname, username, remote directory 입력합니다.<br/>
입력이 끝나고 <code>Test Configuration</code> 버튼을 클릭하여 테스트를 해봅니다.</li>
</ul>


</div>

<h3 id="gitlab-plugin">GitLab Plugin</h3>
<p>gitlab 과 연동하기 위한 플러그인입니다.</p>
<p>gitlab 에서 push 이벤트가 발생했을 경우 jenkins 에서 build 가 실행되도록 하기위해 사용됩니다.</p>
<ol>
<li>gitlab 에서 <code>User Settings</code> &gt; <code>Access Tokens</code> 메뉴에서 <code>Access Token</code> 을 생성할 것</li>
<li>jenkins 플러그인 관리에서 <code>GitLab Plugin</code> 을 검색하고 설치</li>
<li><code>jenkins 관리</code> &gt; <code>Manage Credentials</code> 로 이동하여 <code>Access Token</code>을 추가함</li>
<li><code>jenkins 관리</code> &gt; <code>시스템 설정</code> 메뉴로 이동하여 <code>Gitlab</code> 섹션으로 이동
<ul>
<li><code>Credentials</code>: <code>Manage Credentials</code>에서 추가한 <code>Gitlab API token</code> 을 선택하고 <code>Test Connection</code> 버튼을 클릭하여 동작을 확인함</li>
</ul>
</li>
<li>프로젝트의 <code>구성</code>에서 <code>빌드 유발</code> 섹션으로 이동
<ul>
<li><code>Build when a change is pushed to GitLab. GitLab webhook URL: http://jenkins/project/boot-www</code>: 이 항목을 체크하면 세부 항목들이 나타남. (세부 항목에 대해 모르면 기본 체크 상태 유지)</li>
<li><code>Secret token</code>: (이 항목은 <code>고급</code> 버튼을 클릭해야 나타남) <code>Generate</code> 버튼을 클릭하면 값이 생성됨.</li>
</ul>
</li>
</ol>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">GitLab webhook URL, Secret token 항목을 gitlab Webhooks 에 설정하기</h4>

    <p>아래 2개의 항목은 gitlab 의 프로젝트 설정의 <code>Webhooks</code> 에서 설정해야하는 값입니다.</p>
<ul>
<li><code>GitLab webhook URL</code>: 이 값은 체크항목에 레이블로 표시되어있는 <code>http://jenkins/project/boot-www</code> 이며, <code>Webhooks</code> 의 <code>URL</code> 에 입력해야 하는 값.</li>
<li><code>Secret token</code>: 이 값은 <code>Generate</code> 버튼 클릭으로 생성되며, <code>Webhooks</code> 의 <code>Secret Token</code> 에 입력해야 하는 값.</li>
</ul>


</div>

<h3 id="github-integration-plugin">GitHub Integration Plugin</h3>
<p>github 저장소에서 webhook 으로 push 이벤트를 받아서 jenkins build가 실행되도록 할 때 사용합니다.</p>
<p>활용법: <a href="#github-연결">github 연결</a></p>
<h2 id="build">build</h2>
<h3 id="분산-빌드-환경">분산 빌드 환경</h3>
<p><code>jenkins 관리</code> 에서 <code>노드 관리</code> 메뉴로 이동하면 <code>분산 빌드 환경</code>을 위한 노드를 추가할 수 있습니다.</p>
<p>이 환경을 구성하면 jenkins 가 설치된 서버에서는 더 이상 빌드를 수행하지 않고 추가된 노드에서 빌드가 수행됩니다.</p>
<p>다음은 windows 환경의 slave-node를 추가하는 예시입니다.
(jenkins 는 master-node이며, 추가되는 node들은 slave-node 입니다.)</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">주요 설정 항목</h4>

    <ul>
<li><code>Name</code>: slave-node 이름 (설명에는 <code>9900K</code> 로 했습니다.)</li>
<li><code>Remote root directory</code>: slave-node 의 workspace 디렉토리를 지정합니다.
참고로 <code>Z:\jenkins</code> 라고 입력하면 빌드 시 <code>Z:\jenkins\workspace\boot-www</code> 디렉토리가 생성됩니다. (<code>boot-www</code> 는 jenkins 프로젝트명 입니다.)</li>
<li><code>Labels</code>: jenkins 프로젝트에 label 을 설정할 수 있으며, 해당 프로젝트에 포함된 label 과 매핑된 노드에서 빌드가 수행됨</li>
<li><code>Launch method</code>: <code>Use WebSocket</code> 항목을 체크할 것</li>
</ul>


</div>

<p>slave-node 를 추가하면 slave-node에서 jenkins 와 연결하는 방법을 알려줍니다.</p>
<pre><code>Connect agent to Jenkins one of these ways:

Java Web Start is not available for the JVM version running Jenkins

Run from agent command line:

javaws http://jenkins/computer/9900K/jenkins-agent.jnlp
Or if the agent is headless:

java -jar agent.jar -jnlpUrl http://jenkins/computer/9900K/jenkins-agent.jnlp -workDir &quot;Z:\jenkins&quot;
</code></pre><p>slave-node 와 jenkins 연결하기</p>
<ol>
<li>
<p><code>Z:\jenkins</code> 에 agent.jar 를 다운로드 받음</p>
</li>
<li>
<p><code>Z:\jenkins\start-agent.cmd</code> 파일을 생성하고 아래 내용으로 설정</p>
<pre><code>set JAVA_HOME=Z:\develop\java\openjdk-11.0.2
set PATH=%JAVA_HOME%\bin;%PATH%

java -jar agent.jar -jnlpUrl http://jenkins/computer/9900K/jenkins-agent.jnlp -workDir &quot;Z:\jenkins&quot;
</code></pre></li>
<li>
<p><code>start-agent.cmd</code> 실행 후 아래와 같이 console 로그가 출력되면 정상 실행</p>
<pre><code>Z:\jenkins&gt;set JAVA_HOME=Z:\develop\java\openjdk-11.0.2

Z:\jenkins&gt;set PATH=Z:\develop\java\openjdk-11.0.2\bin;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Windows\System32\OpenSSH\;C:\Program Files (x86)\NVIDIA Corporation\PhysX\Common;C:\Program Files\NVIDIA Corporation\NVIDIA NvDLISR;C:\Program Files\Git\cmd;C:\Program Files\nodejs\;C:\Users\Administrator\AppData\Local\Microsoft\WindowsApps;Z:\oracle\ora12c_32bit\client_12_1\bin;Z:\develop\java\openjdk-11.0.2\bin;Z:\develop\build\maven-3.6.3\bin;C:\Users\Administrator\AppData\Local\Programs\Microsoft VS Code\bin;Z:\develop\hugo\hugo-ext-0.87.0;C:\Users\Administrator\AppData\Roaming\npm;Z:\www\httpd_2.4.25-win64-VC14\openssl-0.9.8e_X64\bin;

Z:\jenkins&gt;java -jar agent.jar -jnlpUrl http://jenkins/computer/9900K/jenkins-agent.jnlp -workDir &quot;Z:\jenkins&quot;
9월 13, 2021 11:55:53 오후 org.jenkinsci.remoting.engine.WorkDirManager initializeWorkDir
INFO: Using Z:\jenkins\remoting as a remoting work directory
9월 13, 2021 11:55:53 오후 org.jenkinsci.remoting.engine.WorkDirManager setupLogging
INFO: Both error and output logs will be printed to Z:\jenkins\remoting
9월 13, 2021 11:55:53 오후 hudson.remoting.jnlp.Main createEngine
INFO: Setting up agent: 9900K
9월 13, 2021 11:55:53 오후 hudson.remoting.jnlp.Main$CuiListener &lt;init&gt;
INFO: Jenkins agent is running in headless mode.
9월 13, 2021 11:55:53 오후 hudson.remoting.Engine startEngine
INFO: Using Remoting version: 4.10
9월 13, 2021 11:55:53 오후 org.jenkinsci.remoting.engine.WorkDirManager initializeWorkDir
INFO: Using Z:\jenkins\remoting as a remoting work directory
9월 13, 2021 11:55:53 오후 hudson.remoting.jnlp.Main$CuiListener status
INFO: WebSocket connection open
9월 13, 2021 11:55:53 오후 hudson.remoting.jnlp.Main$CuiListener status
INFO: Connected
</code></pre><p>참고로 여기서 연결이 안되는 상황이 발생함</p>
<ul>
<li>agent.jar 실행 시 jenkins 에 접속할 때 websocket 으로 접속을 하게되는데 ssl 이 적용된 프로토콜 https, wss 은 handshake 오류가 발생함<br/>
httpd 설정에 http 를 https 로 redirect 하도록 mod_rewrite 를 설정했는데 오류로 인해 rewrite 설정은 제거함<br/></li>
<li>jenkins 의 가상호스트 설정은 다음과 같습니다.
<pre><code>&lt;VirtualHost *:80&gt;
  ServerName jenkins

  ErrorLog &quot;|/usr/sbin/rotatelogs /outlog/WEB/httpd/jenkins-error.log.%Y-%m-%d 86400 +540&quot;
  CustomLog &quot;|/usr/sbin/rotatelogs /outlog/WEB/httpd/jenkins-access.log.%Y-%m-%d 86400 +540&quot; combined

  AllowEncodedSlashes On
  Header set Access-Control-Allow-Origin &quot;*&quot;

  RewriteEngine On
  RewriteCond %{HTTP:Upgrade} =websocket [NC]
  RewriteRule /(.*) ws://localhost:8400/$1 [P,L]
  RewriteCond %{HTTP:Upgrade} !=websocket [NC]
  RewriteRule /(.*) http://localhost:8400/$1 [P,L]
&lt;/VirtualHost&gt;
</code></pre></li>
</ul>
</li>
<li>
<p>jenkins 프로젝트에 label 을 추가된 slave-node 의 label 로 변경하고 빌드를 실행하면 <code>Z:\jenkins\workspace\</code> 디렉토리에 jenkins 프로젝트 디렉토리가 생성되고 <code>소스 코드 관리</code>를 설정했을 경우 소스코드가 checkout 되어있을 것입니다.</p>
</li>
</ol>
<ul>
<li>이후 <code>Publish Over SSH</code> 플러그인을 사용하여 was 서버에 war 파일을 publish 를 하고 was 를 재시작하는 command 를 ssh 로 수행하도록 설정하면 됩니다.</li>
</ul>
<h3 id="github-연결">github 연결</h3>
<p>required plugin: <code>GitHub Integration Plugin</code></p>
<p>jenkins 프로젝트의 <code>소스 코드 관리</code> 섹션에서 github 저장소와 연결하는 설정입니다.</p>
<ul>
<li><code>Repository URL</code>: github 의 프로젝트 저장소 url 을 입력 <code>https://github.com/lislroow/spring.git</code></li>
<li><code>Credentials</code>: github 에서 <code>Personal access tokens</code> 을 발급받고 jenkins 에 등록하고 선택</li>
</ul>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">github 에서 Personal access tokens 발급 및 jenkins Credentials 등록</h4>

    <ol>
<li>github 로그인 후 <code>Settings</code> &gt; <code>Developer settings</code> &gt; <code>Personal access tokens</code> 메뉴 이동</li>
<li><code>Generate new token</code> 버튼 클릭 후 <code>Expiration</code> 과 <code>Select scopes</code> 를 선택<br/>
<code>Select scopes</code>은 <code>repo</code>, <code>admin:repo_hook</code>를 전체 선택</li>
<li><code>Generate token</code> 버튼 클릭으로 토큰을 생성
<ul>
<li>생성된 토큰(access token) 값은 다시 확인할 수 없습니다. (재생성해야하는 것으로 알고 있음)</li>
<li>jenkins 에 등록될 access token 은 github 의 id 와 함께 사용되는 패스워드입니다.</li>
</ul>
</li>
<li>jenkins <code>Manage Credentials</code> 에서 <code>Add Credentials</code> 을 합니다.
<ul>
<li><code>Kind</code>: <code>Username with password</code> 를 선택합니다.</li>
<li><code>Username</code>: github 에 로그인할 때 사용하는 id 를 입력합니다. (<code>lislroow</code>)</li>
<li><code>Password</code>: github 에서 생성한 토큰(access token)을 입력합니다. (<code>ghp_***생략***</code>)</li>
</ul>
</li>
</ol>


</div>

<p>jenkins 프로젝트의 <code>빌드 유발</code> 섹션에서 github 저장소에 push 이벤트를 받을 수 있도록 설정합니다.
<code>GitHub hook trigger for GITScm polling</code> 체크</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">github 에서 push 이벤트 jenkins 로 전송하기</h4>

    <ol>
<li>github 의 프로젝트로 이동한 다음 <code>Settings</code> &gt; <code>Webhooks</code> 메뉴로 이동합니다.</li>
<li><code>Add webhook</code> 버튼을 클릭하여 다음을 입력합니다.
<ul>
<li><code>Payload URL</code>: <code>http://{jenkins-domain}/github-webhook/</code> 으로 입력합니다.<br/>
참고로 uri 는 반드시 <code>/github-webhook/</code> 으로 되어야 합니다. (<code>/github-webhook</code> 으로하면 302 를 응답받고 실패합니다.)<br/>
<code>Payload URL</code> 을 입력하게되면 github 저장소에 push 이벤트가 발생할 때 해당 URL 을 호출하게되고, jenkins 는 이 http 요청을 받고 build 를 실행하게 되는 형태입니다.</li>
<li><code>Content type</code>: <code>application/json</code> 으로 설정</li>
<li>저장 후 소스코드를 수정하고 commit;push 를 하게되면 추가된 webhook 항목을 클릭했을 때 <code>Recent Deliveries</code> 를 볼 수 있습니다.</li>
</ul>
</li>
</ol>


</div>


	
	
	<div class="text-muted mt-5 pt-3 border-top">

</div>

</div>


          </main>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>


<script src="https://cdn.jsdelivr.net/npm/mermaid@8.11.2/dist/mermaid.min.js" integrity="sha384-m8Pdaep6Qk8sW3J6XhPOiwUww3maU9HxZTLvEfSEB4e1UVvTdHyfJsYmEfYqvwLC" crossorigin="anonymous"></script>



<style>
.markmap > svg {
  width: 100%;
  height: 300px;
}
</style>
<script>
window.markmap = {
  autoLoader: { manual: true },
};
</script>
<script src="https://cdn.jsdelivr.net/npm/markmap-autoloader"></script>


<script src='/js/tabpane-persist.js'></script>



<script src='/js/deflate.js'></script>


 

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/katex.min.css" integrity="sha384-Cqd8ihRLum0CCg8rz0hYKPoLZ3uw+gES2rXQXycqnL5pgVQIflxAUDS7ZSjITLb5" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/katex.min.js" integrity="sha384-1Or6BdeNQb0ezrmtGeqQHFpppNd7a/gw29xeiSikBbsb44xu3uAo8c7FwbF5jhbd" crossorigin="anonymous"></script>
 


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/contrib/mhchem.min.js" integrity="sha384-LIgAiYlGSAdpNC9+YDjDPF6JeS/RRIumtNo0CmyQERZ/+g0h9MbuYQwf/5pQ4Y4M"  crossorigin="anonymous"></script>


<script defer src='https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/contrib/auto-render.min.js' integrity='sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl' crossorigin='anonymous' onload='renderMathInElement(document.body, null);'></script>














<script src="/js/main.min.c1b8f3c373b85f900699a7ea81c2038ebbbebcac1a5a4b6e5ef96c24c31790d6.js" integrity="sha256-wbjzw3O4X5AGmafqgcIDjru&#43;vKwaWktuXvlsJMMXkNY=" crossorigin="anonymous"></script>




  </body>
</html>