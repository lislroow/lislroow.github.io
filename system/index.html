<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.110.0">
<link rel="alternate" type="application/rss&#43;xml" href="/system/index.xml">
<meta name="robots" content="index, follow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>system | dlog</title>
<meta name="description" content="">
<meta property="og:title" content="system" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/system/" />
<meta itemprop="name" content="system">
<meta itemprop="description" content=""><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="system"/>
<meta name="twitter:description" content=""/>




<link rel="preload" href="/scss/main.min.2dd31677e64bf4bbac83f1d49710364b36b72bdb2342a892ae07712ae225fa27.css" as="style">
<link href="/scss/main.min.2dd31677e64bf4bbac83f1d49710364b36b72bdb2342a892ae07712ae225fa27.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>

  </head>
  <body class="td-section">
    <header>
      <nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"></span><span class="navbar-brand__name">dlog</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav mt-2 mt-lg-0">
      <li class="nav-item me-4 mb-2 mb-lg-0">
        <a class="nav-link active" href="/system/"><i class='fas fa-book'></i><span class="active">system</span></a>
      </li>
      <li class="nav-item me-4 mb-2 mb-lg-0">
        <a class="nav-link" href="/localenv/"><i class='fas fa-book'></i><span>localenv</span></a>
      </li>
      <li class="nav-item me-4 mb-2 mb-lg-0">
        <a class="nav-link" href="/language/"><i class='fas fa-book'></i><span>language</span></a>
      </li>
      <li class="nav-item me-4 mb-2 mb-lg-0">
        <a class="nav-link" href="/elk/"><i class='fas fa-book'></i><span>ELK</span></a>
      </li>
      </ul>
  </div>
  <div class="navbar-nav d-none d-lg-block">
    
  </div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            
<div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-section-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    <ul class="td-sidebar-nav__section pr-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-system-li">
  <a href="/system/" class="align-left pl-0 active td-sidebar-link td-sidebar-link__section tree-root" id="m-system"><span class="td-sidebar-nav-active-item">system</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-systemcentos8-li">
  <a href="/system/centos8/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-systemcentos8"><span class="">centos8</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-systemcurl-li">
  <a href="/system/curl/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-systemcurl"><span class="">curl</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-systemelk-li">
  <a href="/system/elk/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-systemelk"><span class="">ELK</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-systemhttpd-li">
  <a href="/system/httpd/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-systemhttpd"><span class="">httpd</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-systemjenkins-li">
  <a href="/system/jenkins/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-systemjenkins"><span class="">jenkins</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-systemkibana-li">
  <a href="/system/kibana/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-systemkibana"><span class="">kibana</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-systemlinux-li">
  <a href="/system/linux/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-systemlinux"><span class="">linux</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-systemopenssh-li">
  <a href="/system/openssh/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-systemopenssh"><span class="">openssh</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-systemoracle12c-li">
  <a href="/system/oracle12c/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-systemoracle12c"><span class="">oracle12c</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-systemtar-li">
  <a href="/system/tar/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-systemtar"><span class="">tar</span></a>
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-3 td-sidebar-toc d-print-none">
            
<div class="td-page-meta ms-2 pb-1 pt-2 mb-0">

</div>

            <div class="td-toc">
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#tar--i---use-compress-program">(tar) -I, &ndash;use-compress-program</a></li>
            <li><a href="#centos-xargs">(centos) xargs</a></li>
            <li><a href="#centos-lsof">(centos) lsof</a></li>
            <li><a href="#centos-zsh">(centos) zsh</a></li>
            <li><a href="#systemctl-requires-속성">(systemctl) Requires 속성</a></li>
            <li><a href="#cockpit-grafana-grafana-pcp">(cockpit) grafana, grafana-pcp</a></li>
            <li><a href="#cockpit-cockpit-pcp-설치">(cockpit) cockpit-pcp 설치</a></li>
            <li><a href="#dnf-makecache-오류">(dnf-makecache) 오류</a></li>
            <li><a href="#elk-elasticsearch-패스워드-설정">(ELK) elasticsearch 패스워드 설정</a></li>
            <li><a href="#centos-디스크-size-확장">(centos) 디스크 size 확장</a></li>
            <li><a href="#jenkins-role-based-authorization-strategy-플러그인">(jenkins) Role-based Authorization Strategy 플러그인</a></li>
            <li><a href="#jenkins-ansicolor-플러그인">(jenkins) AnsiColor 플러그인</a></li>
            <li><a href="#ansible">(ansible)</a></li>
            <li><a href="#nexus-cleanup--compact-blob">(nexus) cleanup / compact blob</a></li>
            <li><a href="#shell-script-arguments-iterator">(shell) script arguments iterator</a></li>
            <li><a href="#shell-script-정보">(shell) script 정보</a></li>
            <li><a href="#libxml2-xmllint">(libxml2) xmllint</a></li>
            <li><a href="#vim-vimrc">(vim) .vimrc</a></li>
            <li><a href="#self-signed-cert-git-bash-등록">(self-signed-cert) git-bash 등록</a></li>
            <li><a href="#self-signed-cert-java-등록">(self-signed-cert) java 등록</a></li>
            <li><a href="#self-signed-cert-centos-등록">(self-signed-cert) centos 등록</a></li>
            <li><a href="#shell-script-파일-디렉토리">(shell) script 파일 디렉토리</a></li>
            <li><a href="#shell-process-및-port-체크">(shell) process 및 port 체크</a></li>
            <li><a href="#shell-find-newer-samefile">(shell) find newer samefile</a></li>
            <li><a href="#shell-curl">(shell) curl</a></li>
            <li><a href="#shell-파일명-문자열">(shell) 파일명 문자열</a></li>
            <li><a href="#shell-while-문">(shell) while 문</a></li>
            <li><a href="#shell-for-문">(shell) for 문</a></li>
            <li><a href="#shell-case-문">(shell) case 문</a></li>
            <li><a href="#tomcat-startstop">(tomcat) start/stop</a></li>
            <li><a href="#cockpit">(cockpit)</a></li>
            <li><a href="#mosh">(mosh)</a></li>
            <li><a href="#xmlstarlet">(xmlstarlet)</a></li>
            <li><a href="#oracle-12c-설치">(oracle) 12c 설치</a></li>
            <li><a href="#yum-설치된-목록-확인">(yum) 설치된 목록 확인</a></li>
            <li><a href="#firewall-disabled">(firewall) disabled</a></li>
            <li><a href="#selinux-disabled">(selinux) disabled</a></li>
            <li><a href="#network-ip-설정">(network) ip 설정</a></li>
            <li><a href="#openssl-key-생성-cmd">(openssl) key 생성 cmd</a></li>
            <li><a href="#sed-문자열-치환">(sed) 문자열 치환</a></li>
            <li><a href="#tar-분할-압축">(tar) 분할 압축</a></li>
            <li><a href="#tar-exclude-설정">(tar) exclude 설정</a></li>
            <li><a href="#httpd-설정">(httpd) 설정</a></li>
            <li><a href="#jenkins-설정">(jenkins) 설정</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
    
            
          </aside>
          <main class="col-12 col-md-9 col-xl-7 pl-md-5" role="main">
            
            
            
<div class="td-content">
	<h1>system</h1>
  
	<header class="article-meta">
		

  
    


  
    


  

		
	</header>
	<h4 id="tar--i---use-compress-program">(tar) -I, &ndash;use-compress-program</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ tar -I zstd -xvf zsh-5.8-5-x86_64.pkg.tar.zst
</span></span></code></pre></div><br>
<h4 id="centos-xargs">(centos) xargs</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span># 공백이나 개행문자가 포함된 파일명 삭제
</span></span><span style="display:flex;"><span>$ fine . -type -f -print0 | xargs -O /bin/rm -f
</span></span><span style="display:flex;"><span>$ ls *.txt | xargs cat &gt;&gt; abc.txt
</span></span><span style="display:flex;"><span>$ ls | grep *.bak | xargs -I{} cp {} /home/bak_file
</span></span></code></pre></div><br>
<h4 id="centos-lsof">(centos) lsof</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ lsof -u jenkins -a +D /data
</span></span><span style="display:flex;"><span>$ lsof -i 4
</span></span><span style="display:flex;"><span>$ lsof -t -i TCP:8100
</span></span><span style="display:flex;"><span>$ ps -ef | grep `lsof -t -i tcp:8100`
</span></span><span style="display:flex;"><span>$ lsof -t -i tcp:8100 | xargs kill -9 
</span></span></code></pre></div><br>
<h4 id="centos-zsh">(centos) zsh</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ yum install zsh
</span></span><span style="display:flex;"><span>$ sh -c &#34;$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&#34;
</span></span><span style="display:flex;"><span>$ vi ~/.zshrc
</span></span><span style="display:flex;"><span>ZSH_THEME=&#34;agnoster&#34;
</span></span><span style="display:flex;"><span>$ git clone https://github.com/powerline/fonts.git
</span></span><span style="display:flex;"><span>$ cd fonts &amp;&amp; ./install.sh
</span></span><span style="display:flex;"><span>$ git clone https://github.com/zsh-users/zsh-autosuggestions $ZSH_CUSTOM/plugins/zsh-autosuggestions
</span></span><span style="display:flex;"><span>$ git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting
</span></span><span style="display:flex;"><span>$ vi ~/.zshrc
</span></span><span style="display:flex;"><span>plugins=(
</span></span><span style="display:flex;"><span>  git
</span></span><span style="display:flex;"><span>  zsh-autosuggestions
</span></span><span style="display:flex;"><span>  zsh-syntax-highlighting
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ vi ~/.oh-my-zsh/themes/agnoster.zsh-theme
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>prompt_newline() {
</span></span><span style="display:flex;"><span>  if [[ -n $CURRENT_BG ]]; then
</span></span><span style="display:flex;"><span>    echo -n &#34;%{%k%F{$CURRENT_BG}%}$SEGMENT_SEPARATOR
</span></span><span style="display:flex;"><span>%{%k%F{blue}%}$SEGMENT_SEPARATOR&#34;
</span></span><span style="display:flex;"><span>  else
</span></span><span style="display:flex;"><span>    echo -n &#34;%{%k%}&#34;
</span></span><span style="display:flex;"><span>  fi
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  echo -n &#34;%{%f%}&#34;
</span></span><span style="display:flex;"><span>  CURRENT_BG=&#39;&#39;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>build_prompt() {
</span></span><span style="display:flex;"><span>  RETVAL=$?
</span></span><span style="display:flex;"><span>  prompt_status
</span></span><span style="display:flex;"><span>  prompt_virtualenv
</span></span><span style="display:flex;"><span>  prompt_context
</span></span><span style="display:flex;"><span>  prompt_dir
</span></span><span style="display:flex;"><span>  prompt_git
</span></span><span style="display:flex;"><span>  prompt_hg
</span></span><span style="display:flex;"><span>  prompt_newline
</span></span><span style="display:flex;"><span>  prompt_end
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><a href="/images/system/20220222-centos-zsh.png" target="_blank">새 창 보기</a></p>
<br>
<h4 id="systemctl-requires-속성">(systemctl) Requires 속성</h4>
<p>logstash 서비스를 elasticsearch 서비스의 종속으로 구성해야할 필요가 생겼습니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ vi /etc/systemd/system/logstash.service
</span></span><span style="display:flex;"><span>[Unit]
</span></span><span style="display:flex;"><span>Description=logstash
</span></span><span style="display:flex;"><span>Requires=elasticsearch.service
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># 종속성 확인
</span></span><span style="display:flex;"><span>$ systemctl list-dependencies logstash.service 
</span></span><span style="display:flex;"><span>logstash.service
</span></span><span style="display:flex;"><span>● ├─-.mount
</span></span><span style="display:flex;"><span>● ├─elasticsearch.service
</span></span><span style="display:flex;"><span>● ├─system.slice
</span></span><span style="display:flex;"><span>● └─sysinit.target
</span></span><span style="display:flex;"><span>●   ├─dev-hugepages.mount
</span></span><span style="display:flex;"><span>●   ├─dev-mqueue.mount
</span></span></code></pre></div><br>
<h4 id="cockpit-grafana-grafana-pcp">(cockpit) grafana, grafana-pcp</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ yum install grafana grafana-pcp
</span></span><span style="display:flex;"><span>$ systemctl enable --now grafana-server
</span></span></code></pre></div><p>http://host:3000/ 으로 접속</p>
<p>최초 로그인: <a href="/images/system/20220201-grafana_login_admin_admin.png" target="_blank">새 창 열림</a></p>
<p>포트 변경은 <code>/etc/grafana/grafana.ini</code> 파일에서 <code>http_port = 3000</code> 를 변경하면 됩니다.</p>
<p>서비스 재시작: <code>systemctl restart grafana-server</code></p>
<p>가상호스트 설정: <a href="/files/system/20220201-grafana-vhost.txt" target="_blank">새 창 보기</a></p>
<p>로그인 후 설정</p>
<ul>
<li>좌측 메뉴 <code>Configuration</code> &gt; <code>Plugin</code> 선택</li>
<li><code>Performance Co-Pilot</code> 플러그인을 활성화 (enable 버튼 클릭)</li>
<li><code>cockpit-pcp</code>에서 <code>redis</code> 설치 후 <code>grafana</code>에서 <code>Configuration</code> &gt; <code>Data Sources</code> 선택
<br>(<code>grafana</code>는 cockpit-pcp 의 메트릭 정보를 redis 를 통해 가져옵니다. redis 설치는 cockpit 에서 버튼 클릭 한번으로 끝남)</li>
<li><code>HTTP</code>의 <code>URL</code> 항목만 <code>http://127.0.0.1:44322</code> 으로 입력 후 <code>Save &amp; Test</code> 버튼 클릭</li>
</ul>
<p>대시보드: <a href="/images/system/20220201-grafana_dashboard_PCP_redis.png" target="_blank">새 창 보기</a></p>
<br>
<h4 id="cockpit-cockpit-pcp-설치">(cockpit) cockpit-pcp 설치</h4>
<p>시스템모니터링 기능이며 <code>cockpit-pcp</code>를 설치하여 메트릭 정보를 볼 수 있습니다.</p>
<p><a href="/images/system/20220201-cockpit-pcp.png" target="_blank">새 창 보기</a></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ yum install cockpit-pcp
</span></span><span style="display:flex;"><span>$ systemctl enable pmlogger.service
</span></span><span style="display:flex;"><span>$ systemctl enable pmproxy.service
</span></span><span style="display:flex;"><span>$ systemctl daemon-reload
</span></span><span style="display:flex;"><span>$ systemctl start pmlogger.service
</span></span><span style="display:flex;"><span>$ systemctl start pmproxy.service
</span></span></code></pre></div><p>pmproxy.service 활성화를 통해 여러 머신의 메트릭 정보를 볼 수도 있습니다. (redis 설치됨)</p>
<p>참고: <a href="https://cockpit-project.org/blog/pcp-grafana.html" target="_blank">새 창 보기</a></p>
<br>
<h4 id="dnf-makecache-오류">(dnf-makecache) 오류</h4>
<p><code>dnf-makecache</code>는 centos의 자동업데이트 기능입니다.</p>
<p><code>오류: repo 'appstream': Cannot prepare internal mirrorlist: No URLs in mirrorlist 를 위해 메타데이타 내려받기에 실패하였습니다</code></p>
<p><a href="/files/system/20220201-dnf-makecache_mirrorlist_error.txt" target="_blank">새 창 보기</a></p>
<p>disable 명령어는 다음과 같습니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ gsettings set org.gnome.software download-updates false
</span></span><span style="display:flex;"><span>$ systemctl disable dnf-makecache.service
</span></span><span style="display:flex;"><span>$ systemctl disable dnf-makecache.timer
</span></span></code></pre></div><p>정상 작동하도록 하기 위해 yum 저장소 설정 파일을 수정합니다.</p>
<p><a href="/files/system/20220201-yum_repo.txt" target="_blank">새 창 보기</a></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ sed -i &#39;s/mirrorlist/#mirrorlist/g&#39; /etc/yum.repos.d/CentOS-Linux-*
</span></span><span style="display:flex;"><span>$ sed -i &#39;s|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g&#39; /etc/yum.repos.d/CentOS-Linux-*
</span></span><span style="display:flex;"><span># yum upgrade 테스트
</span></span></code></pre></div><p>참고: dnf 저장소 관리 <a href="https://wnw1005.tistory.com/300" target="_blank">새 창 보기</a></p>
<br>
<h4 id="elk-elasticsearch-패스워드-설정">(ELK) elasticsearch 패스워드 설정</h4>
<p><code>elasticsearch</code>와 <code>kibana</code>에 id/pw 방식의 보안을 적용하기 위해 elasticsearch 에 패스워드를 설정합니다.</p>
<p>elasticsearch 에 패스워드를 설정하는 명령어는 <code>elasticsearch-setup-passwords interactive</code> 입니다.</p>
<p>오류 내용이 <code>ERROR: X-Pack Security is disabled by configuration</code> 으로 나올 경우 설정파일<code>elasticsearch.yml</code>이 기본으로 되어있을 경우 발생합니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ /usr/share/elasticsearch/bin/elasticsearch-setup-passwords interactive
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Unexpected response code [500] from calling GET http://172.28.200.30:8200/_security/_authenticate?pretty
</span></span><span style="display:flex;"><span>It doesn&#39;t look like the X-Pack security feature is enabled on this Elasticsearch node.
</span></span><span style="display:flex;"><span>Please check if you have enabled X-Pack security in your elasticsearch.yml configuration file.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ERROR: X-Pack Security is disabled by configuration.
</span></span><span style="display:flex;"><span>$ 
</span></span></code></pre></div><p>설정파일<code>elasticsearch.yml</code>에서 아래와 같이 옵션을 추가합니다.</p>
<p>참고 링크: <a href="https://opster.com/guides/elasticsearch/security/elasticsearch-x-pack-basic-security-is-off/">새 창 보기</a></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>102 
</span></span><span style="display:flex;"><span>103 # 2022.01.27
</span></span><span style="display:flex;"><span>104 xpack.security.enabled: true
</span></span></code></pre></div><p>설정 추가 후 <code>systemctl restart elasticsearch</code> 재시작을하면 <code>xpack.security.transport.ssl.enabled</code> 을 추가하라는 메시지가 나옵니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>-- Unit elasticsearch.service has begun starting up.
</span></span><span style="display:flex;"><span> 1월 27 18:25:13 centos8 systemd-entrypoint[11169]: ERROR: [1] bootstrap checks failed. You must address the points described in the following [1] lines before starting Elasticsearch.
</span></span><span style="display:flex;"><span> 1월 27 18:25:13 centos8 systemd-entrypoint[11169]: bootstrap check failure [1] of [1]: Transport SSL must be enabled if security is enabled on a [basic] license. Please set [xpack.security.transport.ssl.enabled] to [true] or disa&gt;
</span></span><span style="display:flex;"><span> 1월 27 18:25:13 centos8 systemd-entrypoint[11169]: ERROR: Elasticsearch did not exit normally - check the logs at /outlog/PROD/es/elasticsearch.log
</span></span></code></pre></div><p>변경 후 재시작을 합니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>103 # 2022.01.27
</span></span><span style="display:flex;"><span>104 xpack.security.enabled: true
</span></span><span style="display:flex;"><span>105 xpack.security.transport.ssl.enabled: true
</span></span></code></pre></div><p><code>elasticsearch-setup-passwords interactive</code> 명령으로 패스워드를 설정합니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ /usr/share/elasticsearch/bin/elasticsearch-setup-passwords interactive
</span></span><span style="display:flex;"><span>Initiating the setup of passwords for reserved users elastic,apm_system,kibana,kibana_system,logstash_system,beats_system,remote_monitoring_user.
</span></span><span style="display:flex;"><span>You will be prompted to enter passwords as the process progresses.
</span></span><span style="display:flex;"><span>Please confirm that you would like to continue [y/N]y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Enter password for [elastic]: 
</span></span><span style="display:flex;"><span>passwords must be at least [6] characters long
</span></span><span style="display:flex;"><span>Try again.
</span></span><span style="display:flex;"><span>Enter password for [elastic]: 
</span></span><span style="display:flex;"><span>Reenter password for [elastic]: 
</span></span><span style="display:flex;"><span>Enter password for [apm_system]: 
</span></span><span style="display:flex;"><span>Reenter password for [apm_system]: 
</span></span><span style="display:flex;"><span>Enter password for [kibana_system]: 
</span></span><span style="display:flex;"><span>Reenter password for [kibana_system]: 
</span></span><span style="display:flex;"><span>Enter password for [logstash_system]: 
</span></span><span style="display:flex;"><span>Reenter password for [logstash_system]: 
</span></span><span style="display:flex;"><span>Enter password for [beats_system]: 
</span></span><span style="display:flex;"><span>Reenter password for [beats_system]: 
</span></span><span style="display:flex;"><span>Enter password for [remote_monitoring_user]: 
</span></span><span style="display:flex;"><span>Reenter password for [remote_monitoring_user]: 
</span></span><span style="display:flex;"><span>Changed password for user [apm_system]
</span></span><span style="display:flex;"><span>Changed password for user [kibana_system]
</span></span><span style="display:flex;"><span>Changed password for user [kibana]
</span></span><span style="display:flex;"><span>Changed password for user [logstash_system]
</span></span><span style="display:flex;"><span>Changed password for user [beats_system]
</span></span><span style="display:flex;"><span>Changed password for user [remote_monitoring_user]
</span></span><span style="display:flex;"><span>Changed password for user [elastic]
</span></span><span style="display:flex;"><span>$
</span></span></code></pre></div><p>elasticsearch 의 security 적용으로 인해 kibana 의 설정을 확인해야합니다.</p>
<p>설정파일<code>/etc/kibana/kibana.yml</code>에 아래 내용을 추가하고 kibana를 재시작(<code>systemctl restart kibana</code>)합니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span> <span style="color:#0000cf;font-weight:bold">50</span> <span style="color:#8f5902;font-style:italic">#elasticsearch.username: &#34;kibana_system&#34;</span>
</span></span><span style="display:flex;"><span> <span style="color:#0000cf;font-weight:bold">51</span> <span style="color:#8f5902;font-style:italic">#elasticsearch.password: &#34;pass&#34;</span>
</span></span><span style="display:flex;"><span> <span style="color:#0000cf;font-weight:bold">52</span> elasticsearch.username: <span style="color:#4e9a06">&#34;elastic&#34;</span>
</span></span><span style="display:flex;"><span> <span style="color:#0000cf;font-weight:bold">53</span> elasticsearch.password: <span style="color:#4e9a06">&#34;패스워드&#34;</span>
</span></span></code></pre></div><p>브라우저로 kibana 에 접속하면 id/pw 를 요구합니다.</p>
<p><a href="/images/system/20220127-elastic_security_kibana_login.png" target="_blank">새 창 보기</a></p>
<p>kibana 설정파일<code>/etc/kibana/kibana.yml</code>에 <code>elasticsearch.password</code> 값이 평문이 아닌 encryption 문자열로 설정하겠습니다.</p>
<ul>
<li><code>kibana-keystore</code> 명령어로 key 저장소 생성</li>
<li>생성된 key 저장소에 <code>elasticsearch.password</code> 추가</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># kibana-keystore 의 경로를 확인합니다.</span>
</span></span><span style="display:flex;"><span>$ rpm -ql kibana <span style="color:#000;font-weight:bold">|</span> grep <span style="color:#4e9a06">&#39;/bin/kibana&#39;</span>
</span></span><span style="display:flex;"><span>/usr/share/kibana/bin/kibana
</span></span><span style="display:flex;"><span>/usr/share/kibana/bin/kibana-encryption-keys
</span></span><span style="display:flex;"><span>/usr/share/kibana/bin/kibana-keystore
</span></span><span style="display:flex;"><span>/usr/share/kibana/bin/kibana-plugin
</span></span><span style="display:flex;"><span>$ 
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># key 저장소를 생성합니다.</span>
</span></span><span style="display:flex;"><span>$ /usr/share/kibana/bin/kibana create
</span></span><span style="display:flex;"><span>A Kibana keystore already exists. Overwrite? <span style="color:#ce5c00;font-weight:bold">[</span>y/N<span style="color:#ce5c00;font-weight:bold">]</span> N
</span></span><span style="display:flex;"><span>Exiting without modifying keystore.
</span></span><span style="display:flex;"><span>$
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 이미 key 저장소가 있다고하여 저장소를 확인해보려 했지만 찾을 수 없었습니다.</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 어딘가에 key 저장소가 있다고 생각하고 add 를 합니다.</span>
</span></span><span style="display:flex;"><span>$ 
</span></span><span style="display:flex;"><span>$ ./kibana-keystore add elasticsearch.password
</span></span><span style="display:flex;"><span>Enter value <span style="color:#204a87;font-weight:bold">for</span> elasticsearch.password: *********
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 저장된 key 를 확인합니다.</span>
</span></span><span style="display:flex;"><span>$ ./kibana-keystore list
</span></span><span style="display:flex;"><span>elasticsearch.password
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># kibana.yml 설정파일에 &#34;elasticsearch.password&#34; 항목을 주석처리 합니다.</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># kibana 에서 관리하는 key 저장소에 등록된 값으로 사용될 것입니다.</span>
</span></span><span style="display:flex;"><span>$ vi /etc/kibana/kibana.yml
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#elasticsearch.password=패스워드</span>
</span></span></code></pre></div><p>kibana-keystore 에 정상적으로 등록되지 않았다면 아래와 같은 로그를 만나게 됩니다.</p>
<p>아래 오류를 보기위해 테스트를 하려면,</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ./kibana-keystore list
</span></span><span style="display:flex;"><span>elasticsearch.password
</span></span><span style="display:flex;"><span>$ ./kibana-keystore remove elasticsearch.password
</span></span><span style="display:flex;"><span>$ ./kibana-keystore list
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ systemctl restart kibana
</span></span><span style="display:flex;"><span>$ tail -f /outlog/PROD/kibana/kibana.log
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#a40000">#</span> <span style="color:#a40000">서비스</span> <span style="color:#a40000">오류</span> <span style="color:#a40000">로그:</span> <span style="color:#a40000">key</span> <span style="color:#a40000">를</span> <span style="color:#a40000">찾을</span> <span style="color:#a40000">수</span> <span style="color:#a40000">없을</span> <span style="color:#a40000">경우</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;log&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;@timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;2022-01-27T20:40:02+09:00&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;tags&#34;</span><span style="color:#000;font-weight:bold">:[</span><span style="color:#4e9a06">&#34;warning&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;plugins&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;alerting&#34;</span><span style="color:#000;font-weight:bold">],</span><span style="color:#204a87;font-weight:bold">&#34;pid&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">14494</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;APIs are disabled because the Encrypted Saved Objects plugin is missing encryption key. Please set xpack.encryptedSavedObjects.encryptionKey in the kibana.yml or use the bin/kibana-encryption-keys command.&#34;</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;log&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;@timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;2022-01-27T20:40:02+09:00&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;tags&#34;</span><span style="color:#000;font-weight:bold">:[</span><span style="color:#4e9a06">&#34;info&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;plugins&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;ruleRegistry&#34;</span><span style="color:#000;font-weight:bold">],</span><span style="color:#204a87;font-weight:bold">&#34;pid&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">14494</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;Installing common resources shared between all indices&#34;</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;log&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;@timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;2022-01-27T20:40:02+09:00&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;tags&#34;</span><span style="color:#000;font-weight:bold">:[</span><span style="color:#4e9a06">&#34;warning&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;plugins&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;reporting&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;config&#34;</span><span style="color:#000;font-weight:bold">],</span><span style="color:#204a87;font-weight:bold">&#34;pid&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">14494</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;Chromium sandbox provides an additional layer of protection, but is not supported for Linux CentOS 8.5.2111\n OS. Automatically setting &#39;xpack.reporting.capture.browser.chromium.disableSandbox: true&#39;.&#34;</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;log&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;@timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;2022-01-27T20:40:02+09:00&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;tags&#34;</span><span style="color:#000;font-weight:bold">:[</span><span style="color:#4e9a06">&#34;warning&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;process&#34;</span><span style="color:#000;font-weight:bold">],</span><span style="color:#204a87;font-weight:bold">&#34;pid&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">14494</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;Error [ProductNotSupportedSecurityError]: The client is unable to verify that the server is Elasticsearch due to security privileges on the server side. Some functionality may not be compatible if the server is running an unsupported product.\n    at /usr/share/kibana/node_modules/@elastic/elasticsearch/lib/Transport.js:576:19\n    at onBody (/usr/share/kibana/node_modules/@elastic/elasticsearch/lib/Transport.js:369:9)\n    at IncomingMessage.onEnd (/usr/share/kibana/node_modules/@elastic/elasticsearch/lib/Transport.js:291:11)\n    at IncomingMessage.emit (node:events:402:35)\n    at endReadableNT (node:internal/streams/readable:1343:12)\n    at processTicksAndRejections (node:internal/process/task_queues:83:21)&#34;</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;log&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;@timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;2022-01-27T20:40:03+09:00&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;tags&#34;</span><span style="color:#000;font-weight:bold">:[</span><span style="color:#4e9a06">&#34;error&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;elasticsearch-service&#34;</span><span style="color:#000;font-weight:bold">],</span><span style="color:#204a87;font-weight:bold">&#34;pid&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">14494</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;Unable to retrieve version information from Elasticsearch nodes. security_exception: [security_exception] Reason: missing authentication credentials for REST request [/_nodes?filter_path=nodes.*.version%2Cnodes.*.http.publish_address%2Cnodes.*.ip]&#34;</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a40000">#</span> <span style="color:#a40000">서비스</span> <span style="color:#a40000">정상</span> <span style="color:#a40000">로그</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;log&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;@timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;2022-01-27T20:51:17+09:00&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;tags&#34;</span><span style="color:#000;font-weight:bold">:[</span><span style="color:#4e9a06">&#34;warning&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;plugins&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;reporting&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;chromium&#34;</span><span style="color:#000;font-weight:bold">],</span><span style="color:#204a87;font-weight:bold">&#34;pid&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">14712</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;Enabling the Chromium sandbox provides an additional layer of protection.&#34;</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;log&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;@timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;2022-01-27T20:51:19+09:00&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;tags&#34;</span><span style="color:#000;font-weight:bold">:[</span><span style="color:#4e9a06">&#34;info&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;plugins&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;securitySolution&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;endpoint:metadata-check-transforms-task:0&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;0&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;1&#34;</span><span style="color:#000;font-weight:bold">],</span><span style="color:#204a87;font-weight:bold">&#34;pid&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">14712</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;no endpoint metadata transforms found&#34;</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;log&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;@timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;2022-01-27T20:51:26+09:00&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;tags&#34;</span><span style="color:#000;font-weight:bold">:[</span><span style="color:#4e9a06">&#34;info&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;status&#34;</span><span style="color:#000;font-weight:bold">],</span><span style="color:#204a87;font-weight:bold">&#34;pid&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">14712</span><span style="color:#000;font-weight:bold">,</span><span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;Kibana is now available (was degraded)&#34;</span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><br>
<h4 id="centos-디스크-size-확장">(centos) 디스크 size 확장</h4>
<p><code>lsblk</code> 명령으로 디스크 size 를 확인합니다.</p>
<p>(디스크 sda 가 70G 로 되어있습니다.)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ lsblk 
</span></span><span style="display:flex;"><span>NAME                MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
</span></span><span style="display:flex;"><span>sda                   8:0    <span style="color:#0000cf;font-weight:bold">0</span>   70G  <span style="color:#0000cf;font-weight:bold">0</span> disk 
</span></span><span style="display:flex;"><span>├─sda1                8:1    <span style="color:#0000cf;font-weight:bold">0</span>    1G  <span style="color:#0000cf;font-weight:bold">0</span> part /boot
</span></span><span style="display:flex;"><span>└─sda2                8:2    <span style="color:#0000cf;font-weight:bold">0</span>   69G  <span style="color:#0000cf;font-weight:bold">0</span> part 
</span></span><span style="display:flex;"><span>  ├─cl_centos8-root 253:0    <span style="color:#0000cf;font-weight:bold">0</span> 56.7G  <span style="color:#0000cf;font-weight:bold">0</span> lvm  /
</span></span><span style="display:flex;"><span>  ├─cl_centos8-swap 253:1    <span style="color:#0000cf;font-weight:bold">0</span>    7G  <span style="color:#0000cf;font-weight:bold">0</span> lvm  <span style="color:#ce5c00;font-weight:bold">[</span>SWAP<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>  └─cl_centos8-home 253:2    <span style="color:#0000cf;font-weight:bold">0</span>  5.3G  <span style="color:#0000cf;font-weight:bold">0</span> lvm  /home
</span></span><span style="display:flex;"><span>sr0                  11:0    <span style="color:#0000cf;font-weight:bold">1</span> 1024M  <span style="color:#0000cf;font-weight:bold">0</span> rom  
</span></span><span style="display:flex;"><span>$
</span></span></code></pre></div><p>guest-os 를 shutdown 하고, vmware 에서 디스크 capacity 를 확장합니다.</p>
<p>(디스크 sda 를 80G 확장합니다.)</p>
<img src="/images/system/20220126-vmware_expand-disk-capacity.png" width="600">
<br>
<br>
<p>guest-os 를 startup 하고 lsblk 로 확장된 크기를 확인합니다.</p>
<p>(디스크 sda 가 80G 로 확장된 것을 확인할 수 있습니다.)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ lsblk
</span></span><span style="display:flex;"><span>NAME                MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
</span></span><span style="display:flex;"><span>sda                   8:0    <span style="color:#0000cf;font-weight:bold">0</span>   80G  <span style="color:#0000cf;font-weight:bold">0</span> disk 
</span></span><span style="display:flex;"><span>├─sda1                8:1    <span style="color:#0000cf;font-weight:bold">0</span>    1G  <span style="color:#0000cf;font-weight:bold">0</span> part /boot
</span></span><span style="display:flex;"><span>└─sda2                8:2    <span style="color:#0000cf;font-weight:bold">0</span>   69G  <span style="color:#0000cf;font-weight:bold">0</span> part 
</span></span><span style="display:flex;"><span>  ├─cl_centos8-root 253:0    <span style="color:#0000cf;font-weight:bold">0</span> 56.7G  <span style="color:#0000cf;font-weight:bold">0</span> lvm  /
</span></span><span style="display:flex;"><span>  ├─cl_centos8-swap 253:1    <span style="color:#0000cf;font-weight:bold">0</span>    7G  <span style="color:#0000cf;font-weight:bold">0</span> lvm  <span style="color:#ce5c00;font-weight:bold">[</span>SWAP<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>  └─cl_centos8-home 253:2    <span style="color:#0000cf;font-weight:bold">0</span>  5.3G  <span style="color:#0000cf;font-weight:bold">0</span> lvm  /home
</span></span><span style="display:flex;"><span>sr0                  11:0    <span style="color:#0000cf;font-weight:bold">1</span> 1024M  <span style="color:#0000cf;font-weight:bold">0</span> rom  
</span></span><span style="display:flex;"><span>$
</span></span></code></pre></div><p>sda2 를 69G 에서 79G 로 확장합니다. 확장에 사용될 명령어는 <code>growpart</code> 입니다.</p>
<p>패키지가 설치되어 있지 않으면 yum 으로 설치를 합니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ yum install cloud-utils-growpart
</span></span><span style="display:flex;"><span>$ which growpart
</span></span><span style="display:flex;"><span>/usr/bin/growpart
</span></span></code></pre></div><p>growpart 명령으로 피지컬 파티션<code>sda2</code>의 size를 확장합니다.</p>
<p>확장 전에 피지컬 파티션을 상태를 확인합니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ vgdisplay 
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               cl_centos8
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#0000cf;font-weight:bold">4</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#0000cf;font-weight:bold">3</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#0000cf;font-weight:bold">3</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  VG Size               &lt;69.00 GiB
</span></span><span style="display:flex;"><span>  PE Size               4.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#0000cf;font-weight:bold">17663</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#0000cf;font-weight:bold">17663</span> / &lt;69.00 GiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#0000cf;font-weight:bold">0</span> / <span style="color:#0000cf;font-weight:bold">0</span>   
</span></span><span style="display:flex;"><span>  VG UUID               tJ9xgp-NhNP-7kPQ-JwKe-y1TQ-8jkP-1U5ox4
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>$
</span></span></code></pre></div><p>growpart 명령으로 size 를 확장합니다.</p>
<p>확장 후 <code>lsblk</code>, <code>vgdisplay</code> 로 변경된 사항을 확인합니다.</p>
<p>(lsblk 에서 sda2 의 size가 +10G 된 것을 볼 수 있습니다.)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ growpart /dev/sda <span style="color:#0000cf;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span>CHANGED: <span style="color:#000">partition</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span> <span style="color:#000">start</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2099200</span> old: <span style="color:#000">size</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">144701440</span> <span style="color:#000">end</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">146800640</span> new: <span style="color:#000">size</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">165672927</span> <span style="color:#000">end</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">167772127</span>
</span></span><span style="display:flex;"><span>$ lsblk 
</span></span><span style="display:flex;"><span>NAME                MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
</span></span><span style="display:flex;"><span>sda                   8:0    <span style="color:#0000cf;font-weight:bold">0</span>   80G  <span style="color:#0000cf;font-weight:bold">0</span> disk 
</span></span><span style="display:flex;"><span>├─sda1                8:1    <span style="color:#0000cf;font-weight:bold">0</span>    1G  <span style="color:#0000cf;font-weight:bold">0</span> part /boot
</span></span><span style="display:flex;"><span>└─sda2                8:2    <span style="color:#0000cf;font-weight:bold">0</span>   79G  <span style="color:#0000cf;font-weight:bold">0</span> part 
</span></span><span style="display:flex;"><span>  ├─cl_centos8-root 253:0    <span style="color:#0000cf;font-weight:bold">0</span> 56.7G  <span style="color:#0000cf;font-weight:bold">0</span> lvm  /
</span></span><span style="display:flex;"><span>  ├─cl_centos8-swap 253:1    <span style="color:#0000cf;font-weight:bold">0</span>    7G  <span style="color:#0000cf;font-weight:bold">0</span> lvm  <span style="color:#ce5c00;font-weight:bold">[</span>SWAP<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>  └─cl_centos8-home 253:2    <span style="color:#0000cf;font-weight:bold">0</span>  5.3G  <span style="color:#0000cf;font-weight:bold">0</span> lvm  /home
</span></span><span style="display:flex;"><span>sr0                  11:0    <span style="color:#0000cf;font-weight:bold">1</span> 1024M  <span style="color:#0000cf;font-weight:bold">0</span> rom  
</span></span><span style="display:flex;"><span>$ 
</span></span></code></pre></div><p>피지컬 파티션<code>sda2</code> 에 추가된 용량을 할당해야 합니다. (명령어 <code>pvresize /dev/sda2</code>)</p>
<p>할당 후 vgdisplay 에서 <code>Free PE / Size</code> 에서 변경된 것을 확인할 수 있습니다.</p>
<p>(<code>Free  PE / Size       0 / 0   </code> &gt; <code>Free  PE / Size       2560 / 10.00 GiB</code>)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ vgdisplay 
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               cl_centos8
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#0000cf;font-weight:bold">4</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#0000cf;font-weight:bold">3</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#0000cf;font-weight:bold">3</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  VG Size               &lt;69.00 GiB
</span></span><span style="display:flex;"><span>  PE Size               4.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#0000cf;font-weight:bold">17663</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#0000cf;font-weight:bold">17663</span> / &lt;69.00 GiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#0000cf;font-weight:bold">0</span> / <span style="color:#0000cf;font-weight:bold">0</span>   
</span></span><span style="display:flex;"><span>  VG UUID               tJ9xgp-NhNP-7kPQ-JwKe-y1TQ-8jkP-1U5ox4
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ pvresize /dev/sda2
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#4e9a06">&#34;/dev/sda2&#34;</span> changed
</span></span><span style="display:flex;"><span>  <span style="color:#0000cf;font-weight:bold">1</span> physical volume<span style="color:#ce5c00;font-weight:bold">(</span>s<span style="color:#ce5c00;font-weight:bold">)</span> resized or updated / <span style="color:#0000cf;font-weight:bold">0</span> physical volume<span style="color:#ce5c00;font-weight:bold">(</span>s<span style="color:#ce5c00;font-weight:bold">)</span> not resized
</span></span><span style="display:flex;"><span>$ 
</span></span><span style="display:flex;"><span>$ vgdisplay
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               cl_centos8
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#0000cf;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#0000cf;font-weight:bold">3</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#0000cf;font-weight:bold">3</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  VG Size               &lt;79.00 GiB
</span></span><span style="display:flex;"><span>  PE Size               4.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#0000cf;font-weight:bold">20223</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#0000cf;font-weight:bold">17663</span> / &lt;69.00 GiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#0000cf;font-weight:bold">2560</span> / 10.00 GiB
</span></span><span style="display:flex;"><span>  VG UUID               tJ9xgp-NhNP-7kPQ-JwKe-y1TQ-8jkP-1U5ox4
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ 
</span></span><span style="display:flex;"><span>&lt;br&gt;
</span></span></code></pre></div><p>로지컬 파티션<code>cl_centos8-root</code>을 확장해야 합니다.</p>
<p>로지컬 파티션을 확인부터 합니다. (명령어 <code>lvdisplay</code> 혹은 <code>df</code>로 확인할 수 있습니다.)</p>
<p>(확장할 로지컬 파티션은 <code>/dev/cl_centos8/root</code> 입니다.)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ df -h
</span></span><span style="display:flex;"><span>Filesystem                   Size  Used Avail Use% Mounted on
</span></span><span style="display:flex;"><span>devtmpfs                     3.8G     <span style="color:#0000cf;font-weight:bold">0</span>  3.8G   0% /dev
</span></span><span style="display:flex;"><span>tmpfs                        3.8G     <span style="color:#0000cf;font-weight:bold">0</span>  3.8G   0% /dev/shm
</span></span><span style="display:flex;"><span>tmpfs                        3.8G  9.5M  3.8G   1% /run
</span></span><span style="display:flex;"><span>tmpfs                        3.8G     <span style="color:#0000cf;font-weight:bold">0</span>  3.8G   0% /sys/fs/cgroup
</span></span><span style="display:flex;"><span>/dev/mapper/cl_centos8-root   57G   43G   15G  75% /
</span></span><span style="display:flex;"><span>/dev/sda1                   1014M  378M  637M  38% /boot
</span></span><span style="display:flex;"><span>/dev/mapper/cl_centos8-home  5.4G  372M  5.0G   7% /home
</span></span><span style="display:flex;"><span>//172.28.200.1/share         345G  234G  112G  68% /share
</span></span><span style="display:flex;"><span>tmpfs                        775M     <span style="color:#0000cf;font-weight:bold">0</span>  775M   0% /run/user/0
</span></span><span style="display:flex;"><span>$ 
</span></span><span style="display:flex;"><span>$ lvdisplay 
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/cl_centos8/root
</span></span><span style="display:flex;"><span>  LV Name                root
</span></span><span style="display:flex;"><span>  VG Name                cl_centos8
</span></span><span style="display:flex;"><span>  LV UUID                DzRXf6-roJe-0He9-MBow-ccu0-bWjk-qPxfZS
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#204a87">time</span> centos8, 2021-11-28 12:38:35 +0900
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic"># open                 1</span>
</span></span><span style="display:flex;"><span>  LV Size                &lt;56.66 GiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#0000cf;font-weight:bold">14504</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#204a87">set</span> to     <span style="color:#0000cf;font-weight:bold">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:0
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/cl_centos8/home
</span></span><span style="display:flex;"><span>  LV Name                home
</span></span><span style="display:flex;"><span>  VG Name                cl_centos8
</span></span><span style="display:flex;"><span>  LV UUID                9dT8j9-MTd1-dlO2-ceHH-vnpS-KtGJ-je2ReA
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#204a87">time</span> centos8, 2021-11-28 12:38:35 +0900
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic"># open                 1</span>
</span></span><span style="display:flex;"><span>  LV Size                &lt;5.34 GiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#0000cf;font-weight:bold">1367</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#204a87">set</span> to     <span style="color:#0000cf;font-weight:bold">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:2
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/cl_centos8/swap
</span></span><span style="display:flex;"><span>  LV Name                swap
</span></span><span style="display:flex;"><span>  VG Name                cl_centos8
</span></span><span style="display:flex;"><span>  LV UUID                VSq1ve-Dn73-RLjq-q2GP-wa0r-De07-CO7edF
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#204a87">time</span> centos8, 2021-11-28 12:38:36 +0900
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic"># open                 2</span>
</span></span><span style="display:flex;"><span>  LV Size                7.00 GiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#0000cf;font-weight:bold">1792</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#204a87">set</span> to     <span style="color:#0000cf;font-weight:bold">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:1
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>$
</span></span></code></pre></div><p>로지컬 파티션의 size 확장 명령어 <code>lvextend</code> 를 사용하여 확장합니다.</p>
<p>로지컬 파티션명은 lvdisplay 에 표시되는 <code>/dev/cl_centos8/root</code>를 사용해도되고, df 에 표시되는 <code>/dev/mapper/cl_centos8-root</code>를 사용해도 됩니다.</p>
<p>(df 에서 <code>/dev/mapper/cl_centos8-root</code> 의 size 가 +10G 된 것을 확인할 수 있고, lvdisplay에서도 <code>LV Size                &lt;56.66 GiB</code> &gt; <code>LV Size                &lt;66.66 GiB</code> 로 변경된 것을 확인할 수 있습니다.)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ lvextend -r -l +100%FREE /dev/cl_centos8/root
</span></span><span style="display:flex;"><span>  Size of logical volume cl_centos8/root changed from &lt;56.66 GiB <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">14504</span> extents<span style="color:#ce5c00;font-weight:bold">)</span> to &lt;66.66 GiB <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">17064</span> extents<span style="color:#ce5c00;font-weight:bold">)</span>.
</span></span><span style="display:flex;"><span>  Logical volume cl_centos8/root successfully resized.
</span></span><span style="display:flex;"><span>meta-data<span style="color:#ce5c00;font-weight:bold">=</span>/dev/mapper/cl_centos8-root <span style="color:#000">isize</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">512</span>    <span style="color:#000">agcount</span><span style="color:#ce5c00;font-weight:bold">=</span>4, <span style="color:#000">agsize</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">3713024</span> <span style="color:#000">blks</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ce5c00;font-weight:bold">=</span>                       <span style="color:#000">sectsz</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">512</span>   <span style="color:#000">attr</span><span style="color:#ce5c00;font-weight:bold">=</span>2, <span style="color:#000">projid32bit</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">1</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ce5c00;font-weight:bold">=</span>                       <span style="color:#000">crc</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span>        <span style="color:#000">finobt</span><span style="color:#ce5c00;font-weight:bold">=</span>1, <span style="color:#000">sparse</span><span style="color:#ce5c00;font-weight:bold">=</span>1, <span style="color:#000">rmapbt</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">0</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ce5c00;font-weight:bold">=</span>                       <span style="color:#000">reflink</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span><span style="color:#000">data</span>     <span style="color:#ce5c00;font-weight:bold">=</span>                       <span style="color:#000">bsize</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">4096</span>   <span style="color:#000">blocks</span><span style="color:#ce5c00;font-weight:bold">=</span>14852096, <span style="color:#000">imaxpct</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">25</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ce5c00;font-weight:bold">=</span>                       <span style="color:#000">sunit</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span>      <span style="color:#000">swidth</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span> blks
</span></span><span style="display:flex;"><span><span style="color:#000">naming</span>   <span style="color:#ce5c00;font-weight:bold">=</span>version <span style="color:#0000cf;font-weight:bold">2</span>              <span style="color:#000">bsize</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">4096</span>   ascii-ci<span style="color:#ce5c00;font-weight:bold">=</span>0, <span style="color:#000">ftype</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span><span style="color:#000">log</span>      <span style="color:#ce5c00;font-weight:bold">=</span>internal log           <span style="color:#000">bsize</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">4096</span>   <span style="color:#000">blocks</span><span style="color:#ce5c00;font-weight:bold">=</span>7252, <span style="color:#000">version</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">2</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ce5c00;font-weight:bold">=</span>                       <span style="color:#000">sectsz</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">512</span>   <span style="color:#000">sunit</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span> blks, lazy-count<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span><span style="color:#000">realtime</span> <span style="color:#ce5c00;font-weight:bold">=</span>none                   <span style="color:#000">extsz</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">4096</span>   <span style="color:#000">blocks</span><span style="color:#ce5c00;font-weight:bold">=</span>0, <span style="color:#000">rtextents</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>data blocks changed from <span style="color:#0000cf;font-weight:bold">14852096</span> to <span style="color:#0000cf;font-weight:bold">17473536</span>
</span></span><span style="display:flex;"><span>$ 
</span></span><span style="display:flex;"><span>$ df -h
</span></span><span style="display:flex;"><span>Filesystem                   Size  Used Avail Use% Mounted on
</span></span><span style="display:flex;"><span>devtmpfs                     3.8G     <span style="color:#0000cf;font-weight:bold">0</span>  3.8G   0% /dev
</span></span><span style="display:flex;"><span>tmpfs                        3.8G     <span style="color:#0000cf;font-weight:bold">0</span>  3.8G   0% /dev/shm
</span></span><span style="display:flex;"><span>tmpfs                        3.8G  9.5M  3.8G   1% /run
</span></span><span style="display:flex;"><span>tmpfs                        3.8G     <span style="color:#0000cf;font-weight:bold">0</span>  3.8G   0% /sys/fs/cgroup
</span></span><span style="display:flex;"><span>/dev/mapper/cl_centos8-root   67G   43G   25G  64% /
</span></span><span style="display:flex;"><span>/dev/sda1                   1014M  378M  637M  38% /boot
</span></span><span style="display:flex;"><span>/dev/mapper/cl_centos8-home  5.4G  372M  5.0G   7% /home
</span></span><span style="display:flex;"><span>//172.28.200.1/share         345G  234G  112G  68% /share
</span></span><span style="display:flex;"><span>tmpfs                        775M     <span style="color:#0000cf;font-weight:bold">0</span>  775M   0% /run/user/0
</span></span><span style="display:flex;"><span>$ 
</span></span><span style="display:flex;"><span>$ lvdisplay 
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/cl_centos8/root
</span></span><span style="display:flex;"><span>  LV Name                root
</span></span><span style="display:flex;"><span>  VG Name                cl_centos8
</span></span><span style="display:flex;"><span>  LV UUID                DzRXf6-roJe-0He9-MBow-ccu0-bWjk-qPxfZS
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#204a87">time</span> centos8, 2021-11-28 12:38:35 +0900
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic"># open                 1</span>
</span></span><span style="display:flex;"><span>  LV Size                &lt;66.66 GiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#0000cf;font-weight:bold">17064</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#0000cf;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#204a87">set</span> to     <span style="color:#0000cf;font-weight:bold">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:0
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/cl_centos8/home
</span></span><span style="display:flex;"><span>  LV Name                home
</span></span><span style="display:flex;"><span>  VG Name                cl_centos8
</span></span><span style="display:flex;"><span>  LV UUID                9dT8j9-MTd1-dlO2-ceHH-vnpS-KtGJ-je2ReA
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#204a87">time</span> centos8, 2021-11-28 12:38:35 +0900
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic"># open                 1</span>
</span></span><span style="display:flex;"><span>  LV Size                &lt;5.34 GiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#0000cf;font-weight:bold">1367</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#204a87">set</span> to     <span style="color:#0000cf;font-weight:bold">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:2
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/cl_centos8/swap
</span></span><span style="display:flex;"><span>  LV Name                swap
</span></span><span style="display:flex;"><span>  VG Name                cl_centos8
</span></span><span style="display:flex;"><span>  LV UUID                VSq1ve-Dn73-RLjq-q2GP-wa0r-De07-CO7edF
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#204a87">time</span> centos8, 2021-11-28 12:38:36 +0900
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic"># open                 2</span>
</span></span><span style="display:flex;"><span>  LV Size                7.00 GiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#0000cf;font-weight:bold">1792</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#204a87">set</span> to     <span style="color:#0000cf;font-weight:bold">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:1
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>$
</span></span></code></pre></div><br>
<h4 id="jenkins-role-based-authorization-strategy-플러그인">(jenkins) Role-based Authorization Strategy 플러그인</h4>
<p>플러그인 설치 후 <code>Jenkins 관리</code> &gt; <code>Configure Global Security</code> 메뉴로 이동합니다.</p>
<p><code>Authorization</code> 영역에 <code>Role-Based Strategy</code> 를 체크합니다.</p>
<p><a href="/images/system/20220117-jenkins_role-based-authorization-strategy_plugin.png" target="_blank">새 창 보기</a></p>
<p><code>Jenkins 관리</code> &gt; <code>Manage and Assign Roles</code> 에서 세부 설정을 합니다.</p>
<p><a href="/images/system/20220117-jenkins_role-based-authorization-strategy_config.png" target="_blank">새 창 보기</a></p>
<br>
<h4 id="jenkins-ansicolor-플러그인">(jenkins) AnsiColor 플러그인</h4>
<p>플러그인 설치 후 개별 job 의 <code>구성</code>에서 <code>빌드 환경</code>에 <code>Color ANSI Console Output</code> 을 선택하면 됩니다.</p>
<p>플러그인 설명은 <code>Adds ANSI coloring to the Console Output</code> 입니다.</p>
<p><a href="/images/system/20220117-jenkins_ansicolor_plugin.png" target="_blank">새 창 보기</a></p>
<br>
<h4 id="ansible">(ansible)</h4>
<p>[TODO] 내용 확인 후 세부 작성</p>
<p><code>ansible</code> 설치 로그 <a href="/files/system/20220117-install-ansible_log.txt" target="_blank">새 창 보기</a></p>
<br>
<h4 id="nexus-cleanup--compact-blob">(nexus) cleanup / compact blob</h4>
<p>nexus 저장소에 오래된 snapshot 이 많아져서 공간이 부족해지면 아래 2가지 작업을 등록합니다.</p>
<p>cleanup policy 및 cleanup task 만 등록할 경우 실제 blob 파일은 삭제되지 않기에 <code>compact blob task</code> 까지 등록해야 합니다.</p>
<p>task 등록이 된 다음에는 해당 task 에서 <code>Run</code> 버튼을 클릭하여 실행하고 du 명령어로 공간이 확보된 것을 확인할 수 있을 것입니다.</p>
<ul>
<li>
<p><code>Repository</code> &gt; <code>Cleanup Policies</code> 메뉴에서 정책 등록</p>
<p>cleanup policy 등록: <a href="/images/system/20220114-nexus-cleanup-policy.png" target="_blank">새 창 보기</a></p>
</li>
<li>
<p><code>System</code> &gt; <code>Task</code> 메뉴에서 작업 등록</p>
<p>cleanup task 등록: <a href="/images/system/20220114-nexus-cleanup-task.png" target="_blank">새 창 보기</a></p>
<p>compact blob task 등록: <a href="/images/system/20220114-nexus-compact-blob-task.png" target="_blank">새 창 보기</a></p>
</li>
</ul>
<br>
<h4 id="shell-script-arguments-iterator">(shell) script arguments iterator</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#000">argc</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">$#</span>
</span></span><span style="display:flex;"><span><span style="color:#000">argv</span><span style="color:#ce5c00;font-weight:bold">=(</span><span style="color:#4e9a06">&#34;</span><span style="color:#000">$@</span><span style="color:#4e9a06">&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;argc=</span><span style="color:#4e9a06">${</span><span style="color:#000">argc</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;argv=</span><span style="color:#4e9a06">${</span><span style="color:#000">argv</span><span style="color:#000;font-weight:bold">[*]</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">((</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">=</span>0<span style="color:#000;font-weight:bold">;</span> i&lt;argc<span style="color:#000;font-weight:bold">;</span> i++<span style="color:#ce5c00;font-weight:bold">))</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#204a87;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;argv[</span><span style="color:#000">$i</span><span style="color:#4e9a06">]=</span><span style="color:#4e9a06">${</span><span style="color:#000">argv</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">$i</span><span style="color:#000;font-weight:bold">]</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">done</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ./test.sh a b <span style="color:#4e9a06">&#39;c d&#39;</span> <span style="color:#0000cf;font-weight:bold">3</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">### [start] test.sh a b c d 3 ###</span>
</span></span><span style="display:flex;"><span>+++ <span style="color:#ce5c00;font-weight:bold">(</span>system-env<span style="color:#ce5c00;font-weight:bold">)</span> +++
</span></span><span style="display:flex;"><span><span style="color:#000">SCRIPT_DIR</span><span style="color:#ce5c00;font-weight:bold">=</span>/z/project/pilot/service
</span></span><span style="display:flex;"><span><span style="color:#000">argc</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">4</span>
</span></span><span style="display:flex;"><span><span style="color:#000">argv</span><span style="color:#ce5c00;font-weight:bold">=</span>a b c d <span style="color:#0000cf;font-weight:bold">3</span>
</span></span><span style="display:flex;"><span>argv<span style="color:#ce5c00;font-weight:bold">[</span>0<span style="color:#ce5c00;font-weight:bold">]=</span>a
</span></span><span style="display:flex;"><span>argv<span style="color:#ce5c00;font-weight:bold">[</span>1<span style="color:#ce5c00;font-weight:bold">]=</span>b
</span></span><span style="display:flex;"><span>argv<span style="color:#ce5c00;font-weight:bold">[</span>2<span style="color:#ce5c00;font-weight:bold">]=</span>c d
</span></span><span style="display:flex;"><span>argv<span style="color:#ce5c00;font-weight:bold">[</span>3<span style="color:#ce5c00;font-weight:bold">]=</span><span style="color:#0000cf;font-weight:bold">3</span>
</span></span></code></pre></div><br>
<h4 id="shell-script-정보">(shell) script 정보</h4>
<p>bash 에서 script 파일을 실행할 때 기본 정보를 출력했습니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">echo</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;# arguments called with ----&gt;  </span><span style="color:#4e9a06">${</span><span style="color:#000;font-weight:bold">@</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">     &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;# \$1 ----------------------&gt;  </span><span style="color:#000">$1</span><span style="color:#4e9a06">       &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;# \$2 ----------------------&gt;  </span><span style="color:#000">$2</span><span style="color:#4e9a06">       &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;# path to me ---------------&gt;  </span><span style="color:#4e9a06">${</span><span style="color:#000">0</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">     &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;# parent path --------------&gt;  </span><span style="color:#4e9a06">${</span><span style="color:#000">0</span><span style="color:#000;font-weight:bold">%/*</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">  &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;# my name ------------------&gt;  </span><span style="color:#4e9a06">${</span><span style="color:#000">0</span><span style="color:#000;font-weight:bold">##*/</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">echo</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">exit</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ /z/project/pilot/service/service-www/a.sh <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#0000cf;font-weight:bold">2</span> <span style="color:#0000cf;font-weight:bold">4</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># arguments called with ----&gt;  1 2 4</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># $1 ----------------------&gt;  1</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># $2 ----------------------&gt;  2</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># path to me ---------------&gt;  /z/project/pilot/service/service-www/a.sh</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># parent path --------------&gt;  /z/project/pilot/service/service-www</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># my name ------------------&gt;  a.sh</span>
</span></span></code></pre></div><br>
<h4 id="libxml2-xmllint">(libxml2) xmllint</h4>
<p>xmllint 를 이용하여 nexus 의 maven-metadata.xml 을 파싱하는 예시입니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ <span style="color:#000">XML_URL</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;https://nexus/repository/maven-snapshot/mgkim/framework/framework-online/maven-metadata.xml&#34;</span>
</span></span><span style="display:flex;"><span>$ curl -s <span style="color:#4e9a06">${</span><span style="color:#000">XML_URL</span><span style="color:#4e9a06">}</span> <span style="color:#000;font-weight:bold">|</span> cat -
</span></span><span style="display:flex;"><span>&lt;?xml <span style="color:#000">version</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;1.0&#34;</span> <span style="color:#000">encoding</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;UTF-8&#34;</span>?&gt;
</span></span><span style="display:flex;"><span>&lt;metadata&gt;
</span></span><span style="display:flex;"><span>  &lt;groupId&gt;mgkim.framework&lt;/groupId&gt;
</span></span><span style="display:flex;"><span>  &lt;artifactId&gt;framework-online&lt;/artifactId&gt;
</span></span><span style="display:flex;"><span>  &lt;versioning&gt;
</span></span><span style="display:flex;"><span>    &lt;versions&gt;
</span></span><span style="display:flex;"><span>      &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
</span></span><span style="display:flex;"><span>      &lt;version&gt;2.0-SNAPSHOT&lt;/version&gt;
</span></span><span style="display:flex;"><span>    &lt;/versions&gt;
</span></span><span style="display:flex;"><span>    &lt;lastUpdated&gt;20220110062815&lt;/lastUpdated&gt;
</span></span><span style="display:flex;"><span>  &lt;/versioning&gt;
</span></span><span style="display:flex;"><span>&lt;/metadata&gt;
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># --xpath 에 존재하지 않는 node 명을 입력했을 경우 &#39;XPath set is empty&#39; 가 표시됨</span>
</span></span><span style="display:flex;"><span>$ <span style="color:#204a87">echo</span> <span style="color:#204a87;font-weight:bold">$(</span>curl -s <span style="color:#4e9a06">${</span><span style="color:#000">XML_URL</span><span style="color:#4e9a06">}</span> <span style="color:#000;font-weight:bold">|</span> xmllint --xpath <span style="color:#4e9a06">&#34;//aaa/text()&#34;</span> -<span style="color:#204a87;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>XPath <span style="color:#204a87">set</span> is empty
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># node명 &#34;&lt;groupId&gt;&#34; 의 값을 가져오는 2가지 예시</span>
</span></span><span style="display:flex;"><span>$ <span style="color:#204a87">echo</span> <span style="color:#204a87;font-weight:bold">$(</span>curl -s <span style="color:#4e9a06">${</span><span style="color:#000">XML_URL</span><span style="color:#4e9a06">}</span> <span style="color:#000;font-weight:bold">|</span> xmllint --xpath <span style="color:#4e9a06">&#34;metadata/groupId/text()&#34;</span> -<span style="color:#204a87;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>mgkim.framework
</span></span><span style="display:flex;"><span>$ <span style="color:#204a87">echo</span> <span style="color:#204a87;font-weight:bold">$(</span>curl -s <span style="color:#4e9a06">${</span><span style="color:#000">XML_URL</span><span style="color:#4e9a06">}</span> <span style="color:#000;font-weight:bold">|</span> xmllint --xpath <span style="color:#4e9a06">&#34;//groupId/text()&#34;</span> -<span style="color:#204a87;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>mgkim.framework
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># node명 &#34;&lt;version&gt;&#34; 이 여러개일 경우 마지막만 반환하는 예시</span>
</span></span><span style="display:flex;"><span>$ <span style="color:#204a87">echo</span> <span style="color:#204a87;font-weight:bold">$(</span>curl -s <span style="color:#4e9a06">${</span><span style="color:#000">XML_URL</span><span style="color:#4e9a06">}</span> <span style="color:#000;font-weight:bold">|</span> xmllint --xpath <span style="color:#4e9a06">&#34;//version[last()]/text()&#34;</span> -<span style="color:#204a87;font-weight:bold">)</span> 
</span></span><span style="display:flex;"><span>2.0-SNAPSHOT
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># curl 의 결과를 xmllint 에 전달하기 위해 </span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># xmllint 의 마지막에 dash`-` 문자가 반드시 포함되어야 함</span>
</span></span></code></pre></div><p><code>--xpath</code> 는 쌍따옴표<code>&quot;</code>로 해주세요. (<code>'</code>일 경우 변수를 포함한 값으로 표현이 안됩니다.)</p>
<p>아래는 여러 node 가 select 되는 예시에서 index 변수로 접근하는 예시입니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ <span style="color:#000">XML_URL</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;https://nexus/repository/maven-snapshot/mgkim/framework/framework-online/maven-metadata.xml&#34;</span>
</span></span><span style="display:flex;"><span>$ curl -s <span style="color:#4e9a06">${</span><span style="color:#000">XML_URL</span><span style="color:#4e9a06">}</span> <span style="color:#000;font-weight:bold">|</span> cat -
</span></span><span style="display:flex;"><span>&lt;?xml <span style="color:#000">version</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;1.0&#34;</span> <span style="color:#000">encoding</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;UTF-8&#34;</span>?&gt;
</span></span><span style="display:flex;"><span>&lt;metadata&gt;
</span></span><span style="display:flex;"><span>  &lt;groupId&gt;mgkim.framework&lt;/groupId&gt;
</span></span><span style="display:flex;"><span>  &lt;artifactId&gt;framework-online&lt;/artifactId&gt;
</span></span><span style="display:flex;"><span>  &lt;versioning&gt;
</span></span><span style="display:flex;"><span>    &lt;versions&gt;
</span></span><span style="display:flex;"><span>      &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
</span></span><span style="display:flex;"><span>      &lt;version&gt;2.0-SNAPSHOT&lt;/version&gt;
</span></span><span style="display:flex;"><span>    &lt;/versions&gt;
</span></span><span style="display:flex;"><span>    &lt;lastUpdated&gt;20220110062815&lt;/lastUpdated&gt;
</span></span><span style="display:flex;"><span>  &lt;/versioning&gt;
</span></span><span style="display:flex;"><span>&lt;/metadata&gt;
</span></span><span style="display:flex;"><span>$ <span style="color:#000">count</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">$(</span>curl -s <span style="color:#4e9a06">${</span><span style="color:#000">XML_URL</span><span style="color:#4e9a06">}</span> <span style="color:#000;font-weight:bold">|</span> xmllint --xpath <span style="color:#4e9a06">&#34;count(//version)&#34;</span> -<span style="color:#204a87;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>$ <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;count=</span><span style="color:#4e9a06">${</span><span style="color:#000">count</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">count</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span>$ <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">((</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">=</span>1<span style="color:#000;font-weight:bold">;</span> i&lt;<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">${</span><span style="color:#000">count</span><span style="color:#4e9a06">}</span><span style="color:#000;font-weight:bold">;</span> i++<span style="color:#ce5c00;font-weight:bold">))</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#204a87;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic"># --xpath &#39;//version[$i]/text()&#39; 일 경우</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic"># &#34;XPath error : Undefined variable&#34; 오류가 발생합니다.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87">echo</span> <span style="color:#204a87;font-weight:bold">$(</span>curl -s <span style="color:#4e9a06">${</span><span style="color:#000">XML_URL</span><span style="color:#4e9a06">}</span> <span style="color:#000;font-weight:bold">|</span> xmllint --xpath <span style="color:#4e9a06">&#34;//version[</span><span style="color:#000">$i</span><span style="color:#4e9a06">]/text()&#34;</span> -<span style="color:#204a87;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">done</span>
</span></span><span style="display:flex;"><span>1.0-SNAPSHOT
</span></span><span style="display:flex;"><span>2.0-SNAPSHOT
</span></span></code></pre></div><p>xmllint 는 libxml2 패키지에 포함되어 있습니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ yum provides xmllint
</span></span><span style="display:flex;"><span>마지막 메타자료 만료확인 17:42:56 이전인: 2022년 01월 11일 <span style="color:#ce5c00;font-weight:bold">(</span>화<span style="color:#ce5c00;font-weight:bold">)</span> 오후 04시 01분 22초.
</span></span><span style="display:flex;"><span>libxml2-2.9.7-9.el8_4.2.x86_64 : Library providing XML and HTML support
</span></span><span style="display:flex;"><span>리포지토리      : baseos
</span></span><span style="display:flex;"><span>일치하는 항목 :
</span></span><span style="display:flex;"><span>파일 이름 : /usr/bin/xmllint
</span></span></code></pre></div><br>
<h4 id="vim-vimrc">(vim) .vimrc</h4>
<p><code>vi ~/.vimrc</code> 로 아래 기본 설정을 등록합니다.</p>
<p>.vimrc 에는 # 주석이 오류를 일으키니 설정 시 제거해야 합니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ vi ~/.vimrc
</span></span><span style="display:flex;"><span>if has(&#34;syntax&#34;)
</span></span><span style="display:flex;"><span>  syntax on
</span></span><span style="display:flex;"><span>endif
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>set paste
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># / 검색 강조
</span></span><span style="display:flex;"><span>set hlsearch
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># 자동 들여쓰기
</span></span><span style="display:flex;"><span>set autoindent
</span></span><span style="display:flex;"><span>set cindent
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># tab 설정
</span></span><span style="display:flex;"><span>set ts=2
</span></span><span style="display:flex;"><span>set sts=2
</span></span><span style="display:flex;"><span>set shiftwidth=2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># 커서 위 괄호 강조
</span></span><span style="display:flex;"><span>set showmatch
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># 줄번호와 행번호 표시
</span></span><span style="display:flex;"><span>set ruler
</span></span></code></pre></div><br>
<h4 id="self-signed-cert-git-bash-등록">(self-signed-cert) git-bash 등록</h4>
<p>git-bash 에서 curl 을 사용할 때 ssl 인증 문제가 발생할 경우입니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ curl https://nexus/repository/maven-release/mgkim/service/service-www/maven-metadata.xml
</span></span><span style="display:flex;"><span>curl: (60) SSL certificate problem: self signed certificate
</span></span><span style="display:flex;"><span>More details here: https://curl.se/docs/sslcerts.html
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>curl failed to verify the legitimacy of the server and therefore could not
</span></span><span style="display:flex;"><span>establish a secure connection to it. To learn more about this situation and
</span></span><span style="display:flex;"><span>how to fix it, please visit the web page mentioned above.
</span></span></code></pre></div><p>해당 사이트(<code>https://nexus/</code>)의 crt 파일을 저장하고 git-bash 에서 관리하는 ca-bundle.crt 의 끝부분에 내용을 추가합니다.</p>
<p>파일 경로: <code>C:\Program Files\Git\mingw64\ssl\certs\ca-bundle.crt</code></p>
<br>
<h4 id="self-signed-cert-java-등록">(self-signed-cert) java 등록</h4>
<p>로컬 설치된 java 에 인증서 파일(*.crt) 등록을 하기 위해서는 $JAVA_HOME/bin/keytool 를 사용해야 합니다.</p>
<p>ca 에 등록되지 않은 인증서로 https 통신을 하는 경우에는 ssl-handshake 과정에서 오류가 발생하므로</p>
<p>해당 사이트의 인증서를 로컬 java 에 신뢰할 수 있는 인증서에 등록해야 합니다.</p>
<p>아래는 <code>hello.crt</code> 라는 인증서를 등록하는 예시입니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 인증서 등록</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># oracle java8 에서 cacerts 파일 위치</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># CACERTS=$JAVA_HOME/jre/lib/security/cacerts</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># temurin java11 에서 cacerts 파일 위치</span>
</span></span><span style="display:flex;"><span>$ <span style="color:#000">CACERTS</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">$JAVA_HOME</span>/lib/security/cacerts
</span></span><span style="display:flex;"><span>$ keytool -importcert -keystore <span style="color:#000">$CACERTS</span> -file <span style="color:#4e9a06">&#34;hello.crt&#34;</span> -alias <span style="color:#4e9a06">&#34;hello&#34;</span>
</span></span><span style="display:flex;"><span>키 저장소 비밀번호 입력: <span style="color:#ce5c00;font-weight:bold">(</span>changeit 입력<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>이 인증서를 신뢰합니까? <span style="color:#ce5c00;font-weight:bold">[</span>아니오<span style="color:#ce5c00;font-weight:bold">]</span>:  <span style="color:#ce5c00;font-weight:bold">(</span>y 입력<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>인증서가 키 저장소에 추가되었습니다.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 인증서 조회</span>
</span></span><span style="display:flex;"><span>$ keytool -list -keystore <span style="color:#000">$CACERTS</span> <span style="color:#000;font-weight:bold">|</span> grep <span style="color:#4e9a06">&#34;hello&#34;</span>
</span></span><span style="display:flex;"><span>키 저장소 비밀번호 입력: <span style="color:#ce5c00;font-weight:bold">(</span>changeit 입력<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>hello, 2020. 5. 8, trustedCertEntry,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 인증서 삭제</span>
</span></span><span style="display:flex;"><span>$ keytool -delete -alias <span style="color:#4e9a06">&#34;hello&#34;</span> -keystore <span style="color:#000">$CACERTS</span>
</span></span></code></pre></div><p>nexus 를 https 로 서비스 중인 상태에서 java에 인증서를 등록하지 않았을 경우 아래와 같은 오류가 발생합니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Transfer failed for http://nexus/repository/maven-snapshot/mgkim/service/service-www/2.0-SNAPSHOT/maven-metadata.xml: 
</span></span><span style="display:flex;"><span>PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target -&gt; [Help 1]
</span></span></code></pre></div><p>jenkins 에서 빌드 시 오류가 발생하여 java 에 인증서를 추가합니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ <span style="color:#000">CACERTS</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">$JAVA_HOME</span>/lib/security/cacerts
</span></span><span style="display:flex;"><span>$ keytool -importcert -keystore <span style="color:#000">$CACERTS</span> -file /z/nexus.crt -alias <span style="color:#4e9a06">&#39;nexus&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">### `키 저장소 비밀번호` 에는 changeit 으로 입력해야 합니다. ###</span>
</span></span><span style="display:flex;"><span>$ keytool -importcert -keystore <span style="color:#000">$CACERTS</span> -file /etc/httpd/conf.d/certs/nexus.crt -alias <span style="color:#4e9a06">&#39;nexus&#39;</span>
</span></span><span style="display:flex;"><span>경고: -cacerts 옵션을 사용하여 cacerts 키 저장소에 액세스하십시오.
</span></span><span style="display:flex;"><span>키 저장소 비밀번호 입력:  
</span></span><span style="display:flex;"><span>소유자: <span style="color:#000">CN</span><span style="color:#ce5c00;font-weight:bold">=</span>nexus, <span style="color:#000">OU</span><span style="color:#ce5c00;font-weight:bold">=</span>Dev Team, <span style="color:#000">O</span><span style="color:#ce5c00;font-weight:bold">=</span>SPACESOFT, <span style="color:#000">L</span><span style="color:#ce5c00;font-weight:bold">=</span>Seonyudo, <span style="color:#000">ST</span><span style="color:#ce5c00;font-weight:bold">=</span>Seoul, <span style="color:#000">C</span><span style="color:#ce5c00;font-weight:bold">=</span>KR
</span></span><span style="display:flex;"><span>발행자: <span style="color:#000">CN</span><span style="color:#ce5c00;font-weight:bold">=</span>nexus, <span style="color:#000">OU</span><span style="color:#ce5c00;font-weight:bold">=</span>Dev Team, <span style="color:#000">O</span><span style="color:#ce5c00;font-weight:bold">=</span>SPACESOFT, <span style="color:#000">L</span><span style="color:#ce5c00;font-weight:bold">=</span>Seonyudo, <span style="color:#000">ST</span><span style="color:#ce5c00;font-weight:bold">=</span>Seoul, <span style="color:#000">C</span><span style="color:#ce5c00;font-weight:bold">=</span>KR
</span></span><span style="display:flex;"><span>일련 번호: 7aa1637941794c08365e9f9a3c531189b87f0b5e
</span></span><span style="display:flex;"><span>적합한 시작 날짜: Mon Jan <span style="color:#0000cf;font-weight:bold">10</span> 12:15:12 KST <span style="color:#0000cf;font-weight:bold">2022</span> 종료 날짜: Wed Jan <span style="color:#0000cf;font-weight:bold">10</span> 12:15:12 KST <span style="color:#0000cf;font-weight:bold">2024</span>
</span></span><span style="display:flex;"><span>인증서 지문:
</span></span><span style="display:flex;"><span>   SHA1: D4:A6:92:2A:0C:97:1F:56:93:03:EC:8C:50:B3:27:5D:51:BD:30:63
</span></span><span style="display:flex;"><span>   SHA256: 62:BA:47:E9:3F:A6:A7:7D:78:99:87:E1:9B:E7:23:D5:B6:6B:2A:CC:5E:D9:BF:4A:DB:95:AD:67:47:70:86:96
</span></span><span style="display:flex;"><span>서명 알고리즘 이름: SHA256withRSA
</span></span><span style="display:flex;"><span>주체 공용 키 알고리즘: 2048비트 RSA 키
</span></span><span style="display:flex;"><span>버전: <span style="color:#0000cf;font-weight:bold">3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>확장: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#1: ObjectId: 2.5.29.37 Criticality=false</span>
</span></span><span style="display:flex;"><span>ExtendedKeyUsages <span style="color:#ce5c00;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>  serverAuth
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#2: ObjectId: 2.5.29.15 Criticality=true</span>
</span></span><span style="display:flex;"><span>KeyUsage <span style="color:#ce5c00;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>  DigitalSignature
</span></span><span style="display:flex;"><span>  Key_Agreement
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#3: ObjectId: 2.5.29.17 Criticality=false</span>
</span></span><span style="display:flex;"><span>SubjectAlternativeName <span style="color:#ce5c00;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>  DNSName: nexus
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>이 인증서를 신뢰합니까? <span style="color:#ce5c00;font-weight:bold">[</span>아니오<span style="color:#ce5c00;font-weight:bold">]</span>:  y
</span></span><span style="display:flex;"><span>인증서가 키 저장소에 추가되었습니다.
</span></span><span style="display:flex;"><span>$ 
</span></span></code></pre></div><br>
<h4 id="self-signed-cert-centos-등록">(self-signed-cert) centos 등록</h4>
<ul>
<li><code>/etc/pki/ca-trust/source/anchors/</code> 경로에 crt 파일을 복사</li>
<li><code>update-ca-trust extract</code> 실행으로 신뢰할 수 있는 인증서를 추가</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ cp /etc/httpd/conf.d/certs/nexus.crt /etc/pki/ca-trust/source/anchors/
</span></span><span style="display:flex;"><span>$ update-ca-trust extract
</span></span></code></pre></div><br>
<p><code>update-ca-trust</code> 명령으로 등록이 안될 경우 직접 추가하는 방법입니다.</p>
<p><code>/etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem</code> 파일에 crt 파일의 내용을 직접 추가합니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ chmod u+w /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem
</span></span><span style="display:flex;"><span>$ cat nexus.crt &gt;&gt; /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem
</span></span><span style="display:flex;"><span>$ chmod u-w /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem
</span></span></code></pre></div><br>
<h4 id="shell-script-파일-디렉토리">(shell) script 파일 디렉토리</h4>
<p><code>/project/script/build.sh</code> 파일이 실행될 때 현재 디렉토리<code>/project/script/</code>를 확인하는 방법입니다.</p>
<p>maven 프로젝트의 build.sh 파일이 pom.xml 과 같은 디렉토리가 아닐 경우 활용할 수 있습니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># build.sh 가 존재하는 디렉토리를 반환합니다.</span>
</span></span><span style="display:flex;"><span>$ <span style="color:#000">DIR</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;</span><span style="color:#204a87;font-weight:bold">$(</span> <span style="color:#204a87">cd</span> <span style="color:#204a87;font-weight:bold">$(</span> dirname <span style="color:#4e9a06">&#34;</span><span style="color:#000">$0</span><span style="color:#4e9a06">&#34;</span> <span style="color:#204a87;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> <span style="color:#204a87">pwd</span> -P <span style="color:#204a87;font-weight:bold">)</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span>$ <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">DIR</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span>/home/user/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># build.sh 의 parent 디렉토리를 반환합니다.</span>
</span></span><span style="display:flex;"><span>$ <span style="color:#000">DIR</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;</span><span style="color:#204a87;font-weight:bold">$(</span> <span style="color:#204a87">cd</span> <span style="color:#204a87;font-weight:bold">$(</span> dirname <span style="color:#4e9a06">&#34;</span><span style="color:#000">$0</span><span style="color:#4e9a06">&#34;</span> <span style="color:#204a87;font-weight:bold">)</span>/.. <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> <span style="color:#204a87">pwd</span> -P <span style="color:#204a87;font-weight:bold">)</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span>$ <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">DIR</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span>/home
</span></span></code></pre></div><br>
<h4 id="shell-process-및-port-체크">(shell) process 및 port 체크</h4>
<img src="/images/system/20220110-shell-process-port-check.png" width="800">
<p><a href="/images/system/20220110-shell-process-port-check.png" target="_blank">새 창 보기</a></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#000">APP_HOME</span><span style="color:#ce5c00;font-weight:bold">=</span>/app/WAS/pilot
</span></span><span style="display:flex;"><span><span style="color:#000">APP_NAME</span><span style="color:#ce5c00;font-weight:bold">=</span>service-www
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">LIST</span><span style="color:#ce5c00;font-weight:bold">=(</span>
</span></span><span style="display:flex;"><span>  <span style="color:#4e9a06">&#34;dwww11&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#4e9a06">&#34;dwww12&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#4e9a06">&#34;swww11&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#4e9a06">&#34;swww12&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">for</span> APP_ID in <span style="color:#4e9a06">${</span><span style="color:#000">LIST</span><span style="color:#000;font-weight:bold">[*]</span><span style="color:#4e9a06">}</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;--- </span><span style="color:#4e9a06">${</span><span style="color:#000">APP_ID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> ---&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">PS_CMD</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;ps aux | grep -v grep | grep -v tail |  grep -v .sh | grep </span><span style="color:#4e9a06">${</span><span style="color:#000">APP_ID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87">eval</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">PS_CMD</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">_PID</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">$(</span><span style="color:#204a87">eval</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">PS_CMD</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> | awk &#39;{ print \$2}&#39;&#34;</span><span style="color:#204a87;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">[</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">_PID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span> !<span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;&#34;</span> <span style="color:#ce5c00;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#204a87;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    netstat -ntplu <span style="color:#000;font-weight:bold">|</span> grep <span style="color:#4e9a06">${</span><span style="color:#000">_PID</span><span style="color:#4e9a06">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">SERVER_PORT</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">$(</span>netstat -tnplu <span style="color:#000;font-weight:bold">|</span> grep <span style="color:#4e9a06">${</span><span style="color:#000">_PID</span><span style="color:#4e9a06">}</span> <span style="color:#000;font-weight:bold">|</span> awk <span style="color:#4e9a06">&#39;{ if (match($4, /([0-9]*)$/, m)) print m[0] }&#39;</span><span style="color:#204a87;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">[</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">SERVER_PORT</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span> !<span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;&#34;</span> <span style="color:#ce5c00;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#204a87;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">HTTP_CODE</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">$(</span>curl --write-out <span style="color:#4e9a06">&#34;%{http_code}&#34;</span> --silent --output /dev/null <span style="color:#4e9a06">&#34;http://localhost:</span><span style="color:#4e9a06">${</span><span style="color:#000">SERVER_PORT</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">/&#34;</span><span style="color:#204a87;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">[</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">HTTP_CODE</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#4e9a06">&#34;200&#34;</span> <span style="color:#ce5c00;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#204a87;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">APP_ID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> is avaiable. (SERVER_PORT=</span><span style="color:#4e9a06">${</span><span style="color:#000">SERVER_PORT</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">)&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">APP_ID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> is not avaiable. (SERVER_PORT=</span><span style="color:#4e9a06">${</span><span style="color:#000">SERVER_PORT</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">)&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">APP_ID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> is not avaiable.&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">APP_ID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> is not running&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">done</span>
</span></span></code></pre></div><h4 id="shell-find-newer-samefile">(shell) find newer samefile</h4>
<p>오래된 파일을 찾을 경우, 기준이되는 파일은 제외하는 예시입니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 기준이 되는 파일을 생성 (e.g 1981년 07월 19일)</span>
</span></span><span style="display:flex;"><span>$ touch -t 198107190000.00 a.txt
</span></span><span style="display:flex;"><span>$ ls -al a.txt     <span style="color:#8f5902;font-style:italic"># alias ls=&#39;ls --time-style long-iso &#39; 일 경우 시각까지 표시됨</span>
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#0000cf;font-weight:bold">1</span> root root <span style="color:#0000cf;font-weight:bold">0</span> 1981-07-19 00:00 a.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 기준보다 오래된 파일 생성</span>
</span></span><span style="display:flex;"><span>$ touch -t <span style="color:#0000cf;font-weight:bold">198101010000</span> old.txt
</span></span><span style="display:flex;"><span>$ ls -al old.txt 
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#0000cf;font-weight:bold">1</span> root root <span style="color:#0000cf;font-weight:bold">0</span> 1981-01-01 00:00 old.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># find 검색 (a.txt 파일보다 오래된 파일을 찾음)</span>
</span></span><span style="display:flex;"><span>$ find . -maxdepth <span style="color:#0000cf;font-weight:bold">1</span> -type f ! -newer a.txt -name <span style="color:#4e9a06">&#39;*.txt&#39;</span>
</span></span><span style="display:flex;"><span>./a.txt
</span></span><span style="display:flex;"><span>./old.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># find 검색 (기준이 되는 파일을 제외하고 찾음)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># -samefile 혹은 -name 해도됨</span>
</span></span><span style="display:flex;"><span>$ find . -maxdepth <span style="color:#0000cf;font-weight:bold">1</span> -type f ! -newer a.txt -name <span style="color:#4e9a06">&#39;*.txt&#39;</span> ! -samefile a.txt
</span></span><span style="display:flex;"><span>./old.txt
</span></span></code></pre></div><br>
<h4 id="shell-curl">(shell) curl</h4>
<p>curl 로 http_code 를 받아오는 예시 입니다.</p>
<p>이 예시는 was 가 정상 기동되었는지 확인하는데 활용할 수 있습니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ curl --write-out <span style="color:#4e9a06">&#34;%{http_code}&#34;</span> --silent --output /dev/null <span style="color:#4e9a06">&#34;http://localhost:7100/&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#0000cf;font-weight:bold">200</span> <span style="color:#8f5902;font-style:italic"># 서버가 기동되지 않은 상태이면 즉시 응답이 오며, http_code 는 000 가 반환됩니다.</span>
</span></span></code></pre></div><br>
<h4 id="shell-파일명-문자열">(shell) 파일명 문자열</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 파일명에서 확장자 분리</span>
</span></span><span style="display:flex;"><span>$ <span style="color:#000">FILE_NAME</span><span style="color:#ce5c00;font-weight:bold">=</span>service-www-2.0-SNAPSHOT.jar
</span></span><span style="display:flex;"><span>$ <span style="color:#204a87">echo</span> <span style="color:#4e9a06">${</span><span style="color:#000">FILE_NAME</span><span style="color:#000;font-weight:bold">%.*</span><span style="color:#4e9a06">}</span>
</span></span><span style="display:flex;"><span>service-www-2.0-SNAPSHOT
</span></span><span style="display:flex;"><span>$ <span style="color:#204a87">echo</span> <span style="color:#4e9a06">${</span><span style="color:#000">FILE_NAME</span><span style="color:#000;font-weight:bold">##*.</span><span style="color:#4e9a06">}</span>
</span></span><span style="display:flex;"><span>jar
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 파일경로에서 파일명</span>
</span></span><span style="display:flex;"><span>$ <span style="color:#000">FILE_PATH</span><span style="color:#ce5c00;font-weight:bold">=</span>/app/WAS/pilot/service-www-2.0-SNAPSHOT.jar
</span></span><span style="display:flex;"><span>$ <span style="color:#204a87">echo</span> <span style="color:#4e9a06">${</span><span style="color:#000">FILE_PATH</span><span style="color:#000;font-weight:bold">##*/</span><span style="color:#4e9a06">}</span>
</span></span><span style="display:flex;"><span>service-www-2.0-SNAPSHOT.jar
</span></span></code></pre></div><br>
<h4 id="shell-while-문">(shell) while 문</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#000">PS_CMD</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;ps -ef | grep -v grep | egrep </span><span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">.*\\.jar | awk &#39;{ print \$2 }&#39;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">_PID</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">$(</span><span style="color:#204a87">eval</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">PS_CMD</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span><span style="color:#204a87;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># kill -15 실행</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">kill</span> -15 <span style="color:#000">$_PID</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 프로세스가 종료되었는지 while 문에서 확인</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">while</span> <span style="color:#ce5c00;font-weight:bold">[</span> <span style="color:#000">$i</span> -lt <span style="color:#0000cf;font-weight:bold">600</span> <span style="color:#ce5c00;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">_CHECK_PID</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">$(</span><span style="color:#204a87">eval</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">PS_CMD</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span><span style="color:#204a87;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">[</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">_CHECK_PID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#4e9a06">&#34;&#34;</span> <span style="color:#ce5c00;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#204a87;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">(pid:&#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">_PID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;) killed&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87">break</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">$((</span> <span style="color:#000">$i</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#204a87;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">done</span>
</span></span></code></pre></div><br>
<h4 id="shell-for-문">(shell) for 문</h4>
<p>배열을 생성하고 for 문으로 출력하는 예시 입니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#000">SVR_LIST</span><span style="color:#ce5c00;font-weight:bold">=(</span>
</span></span><span style="display:flex;"><span>  <span style="color:#4e9a06">&#39;172.28.200.20&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#4e9a06">&#39;172.28.200.30&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;SVR_LIST=</span><span style="color:#4e9a06">${</span><span style="color:#000">SVR_LIST</span><span style="color:#000;font-weight:bold">[*]</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">total</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">${#</span><span style="color:#000">SVR_LIST</span><span style="color:#000;font-weight:bold">[*]</span><span style="color:#4e9a06">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">idx</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">for</span> SVR in <span style="color:#4e9a06">${</span><span style="color:#000">SVR_LIST</span><span style="color:#000;font-weight:bold">[*]</span><span style="color:#4e9a06">}</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">idx</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">$((</span> <span style="color:#000">$idx</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#204a87;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;[</span><span style="color:#4e9a06">${</span><span style="color:#000">idx</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">/</span><span style="color:#4e9a06">${</span><span style="color:#000">total</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">]SVR=</span><span style="color:#4e9a06">${</span><span style="color:#000">SVR</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">done</span>
</span></span></code></pre></div><br>
<h4 id="shell-case-문">(shell) case 문</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">case</span> <span style="color:#000">$var</span> in
</span></span><span style="display:flex;"><span>  a*<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic"># a로 시작하는 문자열일 경우</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">;;</span>
</span></span><span style="display:flex;"><span>  a?<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic"># a뒤에 1개의 문자가 올 경우</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">;;</span>
</span></span><span style="display:flex;"><span>  a<span style="color:#ce5c00;font-weight:bold">[</span>bc<span style="color:#ce5c00;font-weight:bold">])</span> <span style="color:#8f5902;font-style:italic"># ab 혹은 ac 일 경우</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">;;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">esac</span>
</span></span></code></pre></div><br>
<h4 id="tomcat-startstop">(tomcat) start/stop</h4>
<p>jamwiki 라는 webapp 을 서비스하는 tomcat 설정 기본입니다.</p>
<p>아래 sh 파일을 포함하여 tomcat 설정에 필요한 파일들만 tgz 로 압축했습니다.</p>
<p><a href="/files/system/20220105-jamwiki.zip" target="_blank">다운로드</a></p>
<p><code>start.sh</code> 파일</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#!/bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#000">PROD_HOME</span><span style="color:#ce5c00;font-weight:bold">=</span>/prod/<span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">DATA_HOME</span><span style="color:#ce5c00;font-weight:bold">=</span>/data/PROD/<span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">LOG_HOME</span><span style="color:#ce5c00;font-weight:bold">=</span>/outlog/PROD/<span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">EXE_USER</span><span style="color:#ce5c00;font-weight:bold">=</span>tomcat
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">PS_CMD</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;ps -ef | grep -v grep | grep -v &#39;.sh&#39; | grep -v rotatelogs | grep -v tail | grep </span><span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">CATALINA_BASE</span><span style="color:#ce5c00;font-weight:bold">=</span>/prod/<span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span>/config
</span></span><span style="display:flex;"><span><span style="color:#000">CATALINA_OUT</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">${</span><span style="color:#000">LOG_HOME</span><span style="color:#4e9a06">}</span>/catalina.out
</span></span><span style="display:flex;"><span><span style="color:#000">JAVA_OPTS</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">JAVA_OPTS</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> -Xms256m -Xmx256m&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">JAVA_OPTS</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">JAVA_OPTS</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> -Djava.net.preferIPv4Stack=true&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> CATALINA_BASE
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> CATALINA_OUT
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> JAVA_OPTS
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">[</span> ! -e <span style="color:#4e9a06">${</span><span style="color:#000">LOG_HOME</span><span style="color:#4e9a06">}</span>/backup <span style="color:#ce5c00;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#204a87;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>  su <span style="color:#4e9a06">${</span><span style="color:#000">EXE_USER</span><span style="color:#4e9a06">}</span> -c <span style="color:#4e9a06">&#39;mkdir -p ${LOG_HOME}/backup&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">[</span> -e <span style="color:#4e9a06">${</span><span style="color:#000">LOG_HOME</span><span style="color:#4e9a06">}</span>/catalina.out <span style="color:#ce5c00;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#204a87;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>  mv <span style="color:#4e9a06">${</span><span style="color:#000">LOG_HOME</span><span style="color:#4e9a06">}</span>/catalina.out <span style="color:#4e9a06">${</span><span style="color:#000">LOG_HOME</span><span style="color:#4e9a06">}</span>/backup/catalina.out_<span style="color:#4e9a06">`</span>date +<span style="color:#4e9a06">&#39;%Y%m%d_%H%M%S&#39;</span><span style="color:#4e9a06">`</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">_PID</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">`</span><span style="color:#204a87">eval</span> <span style="color:#4e9a06">${</span><span style="color:#000">PS_CMD</span><span style="color:#4e9a06">}</span> <span style="color:#000;font-weight:bold">|</span> awk <span style="color:#4e9a06">&#39;{ print $2 }&#39;</span><span style="color:#4e9a06">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">[</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">_PID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span> !<span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;&#34;</span> <span style="color:#ce5c00;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#204a87;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> is already running. pid: </span><span style="color:#4e9a06">${</span><span style="color:#000">_PID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#4e9a06">${</span><span style="color:#000">PROD_HOME</span><span style="color:#4e9a06">}</span>/stop-<span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span>.sh
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sleep <span style="color:#0000cf;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">[</span> <span style="color:#4e9a06">${</span><span style="color:#000">EXE_USER</span><span style="color:#4e9a06">}</span> !<span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">`</span>whoami<span style="color:#4e9a06">`</span> <span style="color:#ce5c00;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#204a87;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>  su <span style="color:#4e9a06">${</span><span style="color:#000">EXE_USER</span><span style="color:#4e9a06">}</span> -c <span style="color:#4e9a06">&#39;/prod/${INST_ID}/tomcat/bin/startup.sh&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>  /prod/<span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span>/tomcat/bin/startup.sh
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">_PID</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">`</span><span style="color:#204a87">eval</span> <span style="color:#4e9a06">${</span><span style="color:#000">PS_CMD</span><span style="color:#4e9a06">}</span> <span style="color:#000;font-weight:bold">|</span> awk <span style="color:#4e9a06">&#39;{ print $2 }&#39;</span><span style="color:#4e9a06">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">[</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">_PID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span> !<span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;&#34;</span> <span style="color:#ce5c00;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#204a87;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> is starting. pid: </span><span style="color:#4e9a06">${</span><span style="color:#000">_PID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;ps -ef | grep </span><span style="color:#4e9a06">${</span><span style="color:#000">_PID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;netstat -ntplu | grep </span><span style="color:#4e9a06">${</span><span style="color:#000">_PID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> is not started&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">exit</span> <span style="color:#0000cf;font-weight:bold">0</span>
</span></span></code></pre></div><br>
<p><code>start-jamwiki.sh</code> 파일</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#!/bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">JAVA_HOME</span><span style="color:#ce5c00;font-weight:bold">=</span>/prod/java/jdk1.8.0_202
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">PATH</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">$JAVA_HOME</span>/bin:<span style="color:#000">$PATH</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">INST_ID</span><span style="color:#ce5c00;font-weight:bold">=</span>jamwiki
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/prod/<span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span>/bin/start.sh
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">exit</span> <span style="color:#0000cf;font-weight:bold">0</span>
</span></span></code></pre></div><br>
<p><code>stop.sh</code> 파일</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#!/bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#000">PROD_HOME</span><span style="color:#ce5c00;font-weight:bold">=</span>/prod/<span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">DATA_HOME</span><span style="color:#ce5c00;font-weight:bold">=</span>/data/PROD/<span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">LOG_HOME</span><span style="color:#ce5c00;font-weight:bold">=</span>/outlog/PROD/<span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">EXE_USER</span><span style="color:#ce5c00;font-weight:bold">=</span>tomcat
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">PS_CMD</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;ps -ef | grep -v grep | grep -v &#39;.sh&#39; | grep -v rotatelogs | grep -v tail | grep </span><span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">CATALINA_BASE</span><span style="color:#ce5c00;font-weight:bold">=</span>/prod/<span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span>/config
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> CATALINA_BASE
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">_PID</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">`</span><span style="color:#204a87">eval</span> <span style="color:#4e9a06">${</span><span style="color:#000">PS_CMD</span><span style="color:#4e9a06">}</span> <span style="color:#000;font-weight:bold">|</span> awk <span style="color:#4e9a06">&#39;{ print $2 }&#39;</span><span style="color:#4e9a06">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">[</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">_PID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#4e9a06">&#34;&#34;</span> <span style="color:#ce5c00;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#204a87;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> is not running&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87">exit</span> <span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sleep <span style="color:#0000cf;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">[</span> <span style="color:#4e9a06">${</span><span style="color:#000">EXE_USER</span><span style="color:#4e9a06">}</span> !<span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">`</span>whoami<span style="color:#4e9a06">`</span> <span style="color:#ce5c00;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#204a87;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>  su <span style="color:#4e9a06">${</span><span style="color:#000">EXE_USER</span><span style="color:#4e9a06">}</span> -c <span style="color:#4e9a06">&#39;/prod/${INST_ID}/tomcat/bin/shutdown.sh&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>  /prod/<span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span>/tomcat/bin/shutdown.sh
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;</span><span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> is stopped. pid: </span><span style="color:#4e9a06">${</span><span style="color:#000">_PID</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">exit</span> <span style="color:#0000cf;font-weight:bold">0</span>
</span></span></code></pre></div><br>
<p><code>stop-jamwiki.sh</code> 파일</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#!/bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">INST_ID</span><span style="color:#ce5c00;font-weight:bold">=</span>jamwiki
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/prod/<span style="color:#4e9a06">${</span><span style="color:#000">INST_ID</span><span style="color:#4e9a06">}</span>/bin/stop.sh
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">exit</span> <span style="color:#0000cf;font-weight:bold">0</span>
</span></span></code></pre></div><br>
<p><code>status-jamwiki.sh</code> 파일</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#!/bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;---------------- jamwiki ----------------&#34;</span>
</span></span><span style="display:flex;"><span>ps -ef <span style="color:#000;font-weight:bold">|</span> grep -v grep <span style="color:#000;font-weight:bold">|</span> grep -v <span style="color:#4e9a06">&#39;.sh&#39;</span> <span style="color:#000;font-weight:bold">|</span> grep -v rotatelogs <span style="color:#000;font-weight:bold">|</span> grep -v tail <span style="color:#000;font-weight:bold">|</span> grep jamwiki
</span></span><span style="display:flex;"><span><span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">exit</span> <span style="color:#0000cf;font-weight:bold">0</span>
</span></span></code></pre></div><br>
<h4 id="cockpit">(cockpit)</h4>
<p>cockpit 은 centos 의 web console 을 제공하는 패키지 입니다.</p>
<p>설치</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ dnf install cockpit
</span></span><span style="display:flex;"><span>$ systemctl enable --now cockpit.socket
</span></span><span style="display:flex;"><span>$ netstat -ntplu | grep 9090
</span></span></code></pre></div><p>cockpit 에 ssl 인증서 교체하기</p>
<p>참고: <a href="/files/system/create-cert.sh" target="_blank">create-cert.sh</a></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span># create-cert.sh 로 인증서를 생성합니다.
</span></span><span style="display:flex;"><span># 인자는 web console 에 접근할 도메인으로 생성하면 됩니다.
</span></span><span style="display:flex;"><span># 예시는 centos8 이라는 도메인으로 생성합니다.
</span></span><span style="display:flex;"><span>$ ./create-cert.sh centos8
</span></span><span style="display:flex;"><span>$ ls -al 
</span></span><span style="display:flex;"><span>-rw-r--r--  1 root root 1310  1월  2 14:58 centos8.crt
</span></span><span style="display:flex;"><span>-rw-------  1 root root 1708  1월  2 14:58 centos8.key
</span></span><span style="display:flex;"><span>$ cd /etc/cockpit/ws-certs.d
</span></span><span style="display:flex;"><span>$ ls -al
</span></span><span style="display:flex;"><span>-rw-r--r--  1 root root       2094  1월  2 00:46 0-self-signed-ca.pem
</span></span><span style="display:flex;"><span>-rw-r--r--  1 root root       1684  1월  2 00:46 0-self-signed.cert
</span></span><span style="display:flex;"><span>-rw-r-----  1 root cockpit-ws 1704  1월  2 00:46 0-self-signed.key
</span></span><span style="display:flex;"><span>$ cp centos8.crt centos8.key /etc/cockpit/ws-certs.d
</span></span><span style="display:flex;"><span>$ chmod 640 centos8.key
</span></span><span style="display:flex;"><span>$ chown root:cockpit-ws centos8.key
</span></span><span style="display:flex;"><span>$ chmod 644 centos8.crt
</span></span><span style="display:flex;"><span>$ remotectl certificate centos8.crt centos8.key
</span></span><span style="display:flex;"><span>generated combined certificate file: /etc/cockpit/ws-certs.d/centos8.cert
</span></span><span style="display:flex;"><span>$ remotectl certificate
</span></span><span style="display:flex;"><span>certificate: /etc/cockpit/ws-certs.d/centos8.crt
</span></span><span style="display:flex;"><span>$ systemctl restart cockpit
</span></span></code></pre></div><br>
<p>centos8 인증서 등록하기</p>
<p><code>https://centos8:9090/</code> 링크로 이동하면 신뢰할 수 없는 사이트라고 표시됩니다.</p>
<p>인증서를 내보내기 한 다음 아래 절차대로 인증서를 등록합니다.</p>
<ul>
<li>chrome 에서 <code>chrome://settings/security?q=enhanced</code> 링크로 이동합니다.</li>
<li><code>인증서 관리</code> 메뉴를 클릭하면 팝업이 열립니다.</li>
<li><code>신뢰할 수 있는 루트 인증 기관</code> 탭에서 가져오기를 클릭 합니다.</li>
<li>내보내기 한 인증서를 선택하고 가져오기를 합니다.</li>
<li>chrome 에서 <code>chrome://net-internals/#hsts</code> 링크로 이동합니다.</li>
<li><code>Delete domain security policies</code> 에서 <code>centos8</code> 을 입력하고 <code>Delete</code> 버튼을 클릭합니다.</li>
<li>chrome 에서 <code>chrome://restart</code> 링크 이동으로 chrome 을 재시작합니다.</li>
<li>chrome 에서 <code>https://centos8:9090/</code> 링크로 이동하여 정상 작동하는지를 확인합니다.</li>
</ul>
<p>정상 예시</p>
<p><a href="/images/system/20220102-centos-web_console-cockpit.png" target="_blank">새 창 보기</a></p>
<br>
<p>listen-port 변경하기</p>
<p><code>/etc/systemd/system/sockets.target.wants/cockpit.socket</code> 파일을 아래와 같이 편집합니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>[Unit]
</span></span><span style="display:flex;"><span>Description=Cockpit Web Service Socket
</span></span><span style="display:flex;"><span>Documentation=man:cockpit-ws(8)
</span></span><span style="display:flex;"><span>Wants=cockpit-motd.service
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[Socket]
</span></span><span style="display:flex;"><span>#ListenStream=9090 # 기본값
</span></span><span style="display:flex;"><span>ListenStream=127.0.0.1:8000  # 변경값 (httpd 에서 proxy 로 접근)
</span></span><span style="display:flex;"><span>ExecStartPost=-/usr/share/cockpit/motd/update-motd &#39;&#39; localhost
</span></span><span style="display:flex;"><span>ExecStartPost=-/bin/ln -snf active.motd /run/cockpit/motd
</span></span><span style="display:flex;"><span>ExecStopPost=-/bin/ln -snf inactive.motd /run/cockpit/motd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[Install]
</span></span><span style="display:flex;"><span>WantedBy=sockets.target
</span></span></code></pre></div><p>redhat 공식문서에서는 <code>/etc/systemd/system/cockpit.socket.d/listen.conf</code> 파일을 <code>생성</code>하고 daemon-reload 를 하라고 되어있습니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>[Socket]
</span></span><span style="display:flex;"><span>ListenStream=
</span></span><span style="display:flex;"><span>ListenStream=127.0.0.1:8000
</span></span><span style="display:flex;"><span>FreeBind=yes
</span></span></code></pre></div><p><a href="https://www.freedesktop.org/software/systemd/man/systemd.socket.html#ListenStream=" target="_blank"><a href="https://www.freedesktop.org">www.freedesktop.org</a></a>에서는 아래와 같이 <code>FreeBind=yes</code> 를 권장한다고 되어있습니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>If an IP address is used here, it is often desirable to listen on it before the interface it is configured on is up and running, and even regardless of whether it will be up and running at any point. To deal with this, it is recommended to set the FreeBind= option described below.
</span></span></code></pre></div><p>편집 후 아래 명령어를 실행합니다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ systemctl daemon-reload cockpit.socket
</span></span><span style="display:flex;"><span>$ systemctl restart cockpit.socket
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 변경 상태를 확인합니다.</span>
</span></span><span style="display:flex;"><span>$ netstat -ntplu <span style="color:#000;font-weight:bold">|</span> grep <span style="color:#0000cf;font-weight:bold">8000</span>
</span></span></code></pre></div><h4 id="mosh">(mosh)</h4>
<p>설치</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ yum install mosh
</span></span></code></pre></div><p>상태</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span># 접속 후 netstat 상태 보기
</span></span><span style="display:flex;"><span>$ mosh root@172.28.200.30
</span></span><span style="display:flex;"><span>$ netstat -ntplu | grep 3253
</span></span><span style="display:flex;"><span>udp        0      0 172.28.200.30:60001     0.0.0.0:*                           3253/mosh-server    
</span></span><span style="display:flex;"><span>$ netstat -ntplu | grep 3217
</span></span><span style="display:flex;"><span>udp        0      0 0.0.0.0:19001           0.0.0.0:*                           3217/mosh-client    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># 접속 옵션
</span></span><span style="display:flex;"><span>$ mosh -ssh=&#39;ssh -vvv&#39; root@172.28.200.30
</span></span></code></pre></div><p>chrome 확장 프로그램 <code>Secure Shell</code></p>
<p><a href="https://chrome.google.com/webstore/detail/secure-shell/iodihamcpbpeioajjeobimgagajmlibd/related?hl=ko" target="_blank">링크</a></p>
<br>
<h4 id="xmlstarlet">(xmlstarlet)</h4>
<p>설치</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ dnf install epel-release
</span></span><span style="display:flex;"><span>$ yum install xmlstarlet
</span></span></code></pre></div><p>사용법</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>xmlstarlet sel -N <span style="color:#000">x</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;http://maven.apache.org/POM/4.0.0&#34;</span> -t -v <span style="color:#4e9a06">&#34;x:project/x:version&#34;</span> ./pom.xml
</span></span></code></pre></div><br>
<h4 id="oracle-12c-설치">(oracle) 12c 설치</h4>
<p>oracle 12c ee 버전 설치</p>
<p>pluggable database 설정, MAX_STRING_SIZE 설정, character-set 설정, oracle 계정 설정</p>
<p><a href="/system/oracle12c" target="_blank">새 창 보기</a></p>
<br>
<h4 id="yum-설치된-목록-확인">(yum) 설치된 목록 확인</h4>
<p><code>yum list installed</code></p>
<br>
<h4 id="firewall-disabled">(firewall) disabled</h4>
<p>추가된 목록: /etc/firewalld/zones/public.xml</p>
<p>서비스명: <code>firewalld</code></p>
<br>
<h4 id="selinux-disabled">(selinux) disabled</h4>
<p>파일: /etc/selinux/config</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#000">SELINUX</span><span style="color:#ce5c00;font-weight:bold">=</span>disabled
</span></span></code></pre></div><p>적용: <code>shutdown -r now</code></p>
<br>
<h4 id="network-ip-설정">(network) ip 설정</h4>
<p>파일: /etc/sysconfig/network-scripts/ifcfg-ens33</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#000">BOOTPROTO</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;none&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">IPV6INIT</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;no&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">IPADDR</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;172.28.200.30&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">PREFIX</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;24&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">GATEWAY</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;172.28.200.2&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">DNS1</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;8.8.8.8&#34;</span>
</span></span></code></pre></div><p>적용: <code>systemctl restart NetworkManager</code></p>
<br>
<h4 id="openssl-key-생성-cmd">(openssl) key 생성 cmd</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 암호화하지 않은 개인키</span>
</span></span><span style="display:flex;"><span>$ openssl genrsa -out private_key.pem <span style="color:#0000cf;font-weight:bold">2048</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 3des로 암호화된 개인키 생성</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># passphrase를 입력이 필요합니다.</span>
</span></span><span style="display:flex;"><span>$ openssl genrsa -des3 -out enc_private_key.pem <span style="color:#0000cf;font-weight:bold">2048</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 기존 개인키에 패스워드 추가</span>
</span></span><span style="display:flex;"><span>$ openssl rsa -des3 -in private_key.pem -out enc_private_key.pem
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 기존 개인키에 패스워드 제거</span>
</span></span><span style="display:flex;"><span>$ openssl rsa -in enc_private_key.pem -out private_key.pem
</span></span></code></pre></div><br>
<h4 id="sed-문자열-치환">(sed) 문자열 치환</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ sed -i -e <span style="color:#4e9a06">&#39;s/hello/world/g&#39;</span> test.txt
</span></span></code></pre></div><br>
<h4 id="tar-분할-압축">(tar) 분할 압축</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># split</span>
</span></span><span style="display:flex;"><span>$ tar cvfz - target <span style="color:#000;font-weight:bold">|</span> split -b 3072m - target.tgz
</span></span><span style="display:flex;"><span>$ cat target.tgz.* <span style="color:#000;font-weight:bold">|</span> tar zxvf -
</span></span></code></pre></div><br>
<h4 id="tar-exclude-설정">(tar) exclude 설정</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># exclude</span>
</span></span><span style="display:flex;"><span>$ cat .tarexclude
</span></span><span style="display:flex;"><span>build.*
</span></span><span style="display:flex;"><span>run.*
</span></span><span style="display:flex;"><span>bin
</span></span><span style="display:flex;"><span>.svn/*
</span></span><span style="display:flex;"><span>.git/*
</span></span><span style="display:flex;"><span>.project
</span></span><span style="display:flex;"><span>.tarexclude
</span></span><span style="display:flex;"><span>backup.sh
</span></span><span style="display:flex;"><span>$ tar cvfz ../target.tgz * -X .tarexclude
</span></span></code></pre></div><br>
<h4 id="httpd-설정">(httpd) 설정</h4>
<p>httpd.conf, vhost 설정, ssl 적용에 대한 예시</p>
<p><a href="/system/httpd" target="_blank">새 창 보기</a></p>
<br>
<h4 id="jenkins-설정">(jenkins) 설정</h4>
<p>플러그인 <code>Publish Over SSH</code>, <code>GitLab Plugin</code>, <code>GitHub Integration Plugin</code>에 대한 사용법</p>
<p><a href="/system/jenkins" target="_blank">새 창 보기</a></p>
<br>

        <div class="section-index">
    
    
    
    
    
    
    
    
    
</div>

	
	
	
</div>

          </main>
        </div>
      </div>
    </div>
    
        
    
  <style>
.markmap > svg {
  width: 100%;
  height: 300px;
}
</style>
<script>
window.markmap = {
  autoLoader: {
      manual: true,
      onReady() {
        const { autoLoader, builtInPlugins } = window.markmap;
        autoLoader.transformPlugins = builtInPlugins.filter(plugin => plugin.name !== 'prism');
      },
  },
};
</script>
<script src="https://cdn.jsdelivr.net/npm/markmap-autoloader"></script>
<script src='/js/deflate.js'></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css"
      integrity="sha512-6VMVcy7XQNyarhVuiL50FzpgCFKsyTd6YO93aaQEyET+BNaWvj0IgKR86Bf6+AmWczxAcSnL+JGjo+iStgO1gQ==" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.js"
        integrity="sha512-b9IKj4LCNrtCPBhceRcoYOHWW/S2q9fpl7iAJlyxYpykRj1SKM7FE9+E0NEnJ8g8ni47LBr2GuX9qzg/xeuwzQ=="
        crossorigin="anonymous">
</script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/contrib/mhchem.min.js"
        integrity="sha512-V1hl0fnOXW6Cdqe5ZVqtw8TBpJVpu3XRDRQti96j/04+tMarPrCdXEUE3UdfvfKYTpOn9DV4zEZBVr0HhDiuiQ=="
        crossorigin="anonymous">
</script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/contrib/auto-render.min.js"
       integrity="sha512-iWiuBS5nt6r60fCz26Nd0Zqe0nbk1ZTIQbl3Kv7kYsX+yKMUFHzjaH2+AnM6vp2Xs+gNmaBAVWJjSmuPw76Efg==" crossorigin="anonymous"
       onload='renderMathInElement(document.body, null);'>
</script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@9.2.2/dist/mermaid.min.js" integrity="sha512-IX+bU+wShHqfqaMHLMrtwi4nK6W/Z+QdZoL4kPNtRxI2wCLyHPMAdl3a43Fv1Foqv4AP+aiW6hg1dcrTt3xc+Q==" crossorigin="anonymous"></script>
<script src="/js/main.min.cb60271b4607b0814d09c13d1ba59ea4ff218de622cc7a51c2403d3d292d9320.js" integrity="sha256-y2AnG0YHsIFNCcE9G6WepP8hjeYizHpRwkA9PSktkyA=" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>